(function(e){function t(t){for(var s,r,i=t[0],c=t[1],l=t[2],d=0,m=[];d<i.length;d++)r=i[d],a[r]&&m.push(a[r][0]),a[r]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);u&&u(t);while(m.length)m.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],s=!0,i=1;i<n.length;i++){var c=n[i];0!==a[c]&&(s=!1)}s&&(o.splice(t--,1),e=r(r.s=n[0]))}return e}var s={},a={app:0},o=[];function r(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=s,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var s=n("64a9"),a=n.n(s);a.a},"1ca9":function(e,t,n){},"1e37":function(e,t,n){"use strict";var s=n("3905"),a=n.n(s);a.a},"27b1":function(e,t,n){"use strict";var s=n("6691"),a=n.n(s);a.a},"2f92":function(e,t,n){"use strict";var s=n("763d"),a=n.n(s);a.a},"30d6":function(e,t,n){},3630:function(e,t,n){"use strict";var s=n("aa29"),a=n.n(s);a.a},"36c0":function(e,t,n){},3905:function(e,t,n){},"3ed4":function(e,t,n){"use strict";var s=n("7f22"),a=n.n(s);a.a},4678:function(e,t,n){var s={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function a(e){var t=o(e);return n(t)}function o(e){var t=s[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}a.keys=function(){return Object.keys(s)},a.resolve=o,e.exports=a,a.id="4678"},5250:function(e,t,n){"use strict";var s=n("6b31"),a=n.n(s);a.a},"56d7":function(e,t,n){"use strict";n.r(t);n("0fb7"),n("450d");var s=n("f529"),a=n.n(s),o=(n("bd49"),n("18ff")),r=n.n(o),i=(n("960d"),n("defb")),c=n.n(i),l=(n("cb70"),n("b370")),u=n.n(l),d=(n("bdc7"),n("aa2f")),m=n.n(d),p=(n("de31"),n("c69e")),h=n.n(p),f=(n("a769"),n("5cc3")),g=n.n(f),b=(n("a673"),n("7b31")),v=n.n(b),w=(n("adec"),n("3d2d")),j=n.n(w),y=(n("be4f"),n("896a")),P=n.n(y),S=(n("826b"),n("c263")),_=n.n(S),I=(n("cbb5"),n("8bbc")),k=n.n(I),C=(n("ce18"),n("f58e")),x=n.n(C),O=(n("f225"),n("89a9")),M=n.n(O),L=(n("672e"),n("101e")),$=n.n(L),D=(n("075a"),n("72aa")),G=n.n(D),E=(n("e612"),n("dd87")),V=n.n(E),U=(n("a7cc"),n("df33")),R=n.n(U),T=(n("560b"),n("dcdc")),A=n.n(T),N=(n("5466"),n("ecdf")),q=n.n(N),z=(n("38a0"),n("ad41")),F=n.n(z),B=(n("9d4c"),n("e450")),J=n.n(B),Q=(n("10cb"),n("f3ad")),H=n.n(Q),Y=(n("6611"),n("e772")),X=n.n(Y),W=(n("1f1a"),n("4e4b")),Z=n.n(W),K=(n("eca7"),n("3787")),ee=n.n(K),te=(n("425f"),n("4105")),ne=n.n(te),se=(n("1951"),n("eedf")),ae=n.n(se),oe=(n("8bd8"),n("4cb2")),re=n.n(oe),ie=(n("4ca3"),n("443e")),ce=n.n(ie),le=(n("f4f9"),n("c2cc")),ue=n.n(le),de=(n("7a0f"),n("0f6c")),me=n.n(de),pe=(n("cadf"),n("551c"),n("097d"),n("2b0e")),he=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("el-container",[n("el-header",[n("navbar")],1),n("el-main",{attrs:{id:"main"}},[n("el-row",{attrs:{type:"flex",justify:"center"}},[n("el-col",{attrs:{span:22,sm:18,md:14}},[n("router-view")],1)],1)],1)],1)],1)},fe=[],ge=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",[n("el-header",[n("h1",{staticClass:"layout-navbar-title",staticStyle:{color:"#fff"}},[e._v("大地監控")])]),n("label",{attrs:{for:"menu",id:"burger"},on:{click:function(t){e.isMobile=!e.isMobile}}},[n("font-awesome-icon",{directives:[{name:"show",rawName:"v-show",value:e.isLogined,expression:"isLogined"}],attrs:{icon:"bars"}})],1),e.isMobile?e._e():n("section",{directives:[{name:"show",rawName:"v-show",value:e.isLogined,expression:"isLogined"}],attrs:{id:"nav"}},[n("ul",{staticClass:"nav__items"},[n("li",{staticClass:"nav__item",class:{active:e.isActive("/user-info")},on:{click:function(t){e.toPath("UserInfo")}}},[e._v("\n        帳號資料\n      ")]),n("li",{staticClass:"nav__item",class:{active:e.isActive("/projects")},on:{click:function(t){e.toPath("ProjectList")}}},[e._v("\n        專案列表\n      ")])]),n("ul",{staticClass:"nav__items"},[e.isShow("vg:CRUD")?n("li",{staticClass:"nav__item",class:{active:e.isActive("/vgs")},on:{click:function(t){e.toPath("VGList")}}},[e._v("\n        軸力計設定\n      ")]):e._e(),e.isShow("soItem:CRUD")?n("li",{staticClass:"nav__item",class:{active:e.isActive("/so-items")},on:{click:function(t){e.toPath("SOItemList")}}},[e._v("\n        傾度管設定\n      ")]):e._e(),e.isShow("account:CRUD")?n("li",{staticClass:"nav__item",class:{active:e.isActive("/users")},on:{click:function(t){e.toPath("UserList")}}},[e._v("\n        帳號設定\n      ")]):e._e(),e.isShow("project:CRUD")?n("li",{staticClass:"nav__item",class:{active:e.isActive("/project-setting")||e.isActive("/project-phases")},on:{"!click":function(t){e.projectSubMenuShow=!e.projectSubMenuShow}}},[e._v("\n        專案設定\n        "),e.projectSubMenuShow?n("ul",{staticClass:"nav__sub"},[n("li",{staticClass:"nav__item",class:{active:e.isActive("/project-setting")},on:{click:function(t){e.toPath("ProjectSetting")}}},[e._v("\n            專案資料\n          ")]),n("li",{staticClass:"nav__item",class:{active:e.isActive("/project-phases")},on:{click:function(t){e.toPath("ProjectPhaseList")}}},[e._v("\n            執行階段\n          ")])]):e._e()]):e._e(),e.isShow("permission:CRUD")?n("li",{staticClass:"nav__item",class:{active:e.isActive("/permisson-setup")},on:{click:function(t){e.toPath("PermissionSetup")}}},[e._v("\n        權限設定\n      ")]):e._e(),n("li",{staticClass:"nav__item",on:{click:e.logout}},[e._v("登出")])])])],1)},be=[],ve=(n("6762"),n("2fdb"),{methods:{toPath:function(e,t){this.$router.push({name:e,params:t})}}}),we=ve,je={methods:{roleIs:function(e){return this.$store.getters.myRole===e}}},ye=je,Pe=n("ad3d"),Se={name:"Navbar",mixins:[we,ye],data:function(){return{projectSubMenuShow:!1,isMobile:screen.width<=700}},mounted:function(){window.addEventListener("resize",this.handleResize)},beforeDestroy:function(){window.removeEventListener("resize",this.handleResize)},components:{FontAwesomeIcon:Pe["a"]},computed:{isLogined:function(){return!!this.$store.getters.token},currentRoute:function(){return this.$route.path}},methods:{logout:function(){this.$store.dispatch("logout")},isShow:function(e){return!!this.$store.getters.myPermissions&&this.$store.getters.myPermissions.includes(e)},isActive:function(e){return this.$route.path===e},handleResize:function(e){var t=e.currentTarget.innerWidth;t>=700&&(this.isMobile=!1)}},watch:{currentRoute:function(e){"/project-setting"!==e&&"/project-phases"!==e&&(this.projectSubMenuShow=!1)}}},_e=Se,Ie=(n("5dfc"),n("2877")),ke=Object(Ie["a"])(_e,ge,be,!1,null,null,null),Ce=ke.exports,xe={name:"app",components:{Navbar:Ce}},Oe=xe,Me=(n("034f"),Object(Ie["a"])(Oe,he,fe,!1,null,null,null)),Le=Me.exports,$e=(n("ac6a"),n("5df3"),n("8c4f")),De=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-row",{staticClass:"entry",attrs:{type:"flex",justify:"center"}},[n("el-col",{attrs:{md:8,sm:10,span:12}},[n("el-form",[n("el-form-item",{attrs:{label:"帳號"}},[n("el-input",{attrs:{type:"text",name:"account",placeholder:"請輸入帳號"},on:{input:e.removeError},model:{value:e.account,callback:function(t){e.account=t},expression:"account"}})],1),n("el-form-item",{attrs:{label:"密碼"}},[n("el-input",{attrs:{type:"password",name:"password",placeholder:"請輸入密碼"},on:{input:e.removeError},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),n("el-form-item",[n("p",{staticClass:"feedback"},[e._v("\n          "+e._s(e.feedback)+"\n        ")]),n("div",{staticClass:"button-container"},[n("el-button",{staticStyle:{float:"right"},attrs:{type:"primary","native-type":"submit"},on:{click:function(t){return t.preventDefault(),e.submit(t)}}},[e._v("\n            登入\n          ")])],1)])],1)],1)],1)},Ge=[],Ee={name:"Entry",data:function(){return{account:null,password:null,feedback:""}},methods:{submit:function(){var e=this;return this.account?this.password?void this.$store.dispatch("login",{account:this.account,password:this.password}).then(function(){e.$message({message:"".concat(e.account," 歡迎您"),type:"success",center:!0,duration:1800}),e.$router.push({name:"ProjectList"})}).catch(function(){e.feedback="帳號密碼不匹配"}):this.feedback="請輸入密碼":this.feedback="請輸入帳號"},removeError:function(){this.feedback=""}}},Ve=Ee,Ue=(n("eeb3"),Object(Ie["a"])(Ve,De,Ge,!1,null,null,null)),Re=Ue.exports,Te=function(){var e=this,t=this,n=t.$createElement,s=t._self._c||n;return s("el-row",{staticClass:"user-info",attrs:{type:"flex",justify:"center"}},[s("el-col",{attrs:{xs:18,sm:12,md:12}},[s("h1",[t._v("帳號資料")]),s("el-form",{attrs:{model:t.me,rules:t.rules}},[s("section",[s("h3",[t._v("基本資料")]),s("p",[t._v("姓名："+t._s(t.me.name))]),s("p",[t._v("角色："+t._s(t.me.roleName))]),t.me.company?s("p",[t._v("公司："+t._s(t.me.company.name))]):t._e(),t.me.soItem?s("p",[t._v("傾度管 編號："+t._s(t.me.soItem.number))]):t._e()]),s("h3",[t._v("聯絡方式")]),s("section",[s("el-form-item",{attrs:{label:"電話",prop:"phone"}},[s("el-input",{attrs:{value:t.me.phone,disabled:!t.isShow(),placeholder:"請輸入電話"},on:{change:function(t){return e.updateMe({phone:t})}}})],1),s("el-form-item",{attrs:{label:"email",prop:"email"}},[s("el-input",{attrs:{value:t.me.email,disabled:!t.isShow(),placeholder:"請輸入 email"},on:{change:function(t){return e.updateMe({email:t})}}})],1)],1),s("section",[s("h3",[t._v("密碼設定")]),s("el-form-item",{attrs:{label:"密碼"}},[s("el-checkbox",{staticStyle:{float:"right"},on:{change:function(e){t.showPassword()}}},[t._v("顯示密碼")]),s("el-input",{attrs:{value:t.me.password,type:t.password,disabled:!t.isShow(),placeholder:"請輸入密碼"},on:{change:function(t){return e.updateMe({password:t})}}})],1)],1),s("div",{staticClass:"button-container"},[s("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("\n          確認\n        ")])],1)])],1)],1)},Ae=[],Ne={name:"UserInfo",mixins:[we],data:function(){return{password:"password",rules:{phone:[{required:!0,pattern:/^[0][9]\d{8}$/,message:"請輸入電話號碼 : 09xxxxxxxx",trigger:"blur"}],email:[{required:!0,message:"請輸入 email",trigger:"blur"},{type:"email",message:"請確認格式 example@chuen.com.tw",trigger:["blur","change"]}]}}},computed:{me:function(){return this.$store.getters.me}},methods:{updateMe:function(e){this.$store.commit("updateMe",e)},submit:function(){var e=this;this.$store.dispatch("updateMe").then(function(){e.$message({message:"資料更新成功",type:"success"}),e.toPath("ProjectList")}).catch(function(t){e.$message.error("請重新檢查 ".concat(t.response.data.result))})},isShow:function(){return this.$store.getters.myPermissions.includes("account:updateSelf")},showPassword:function(){"password"===this.password?this.password="text":this.password="password"}}},qe=Ne,ze=Object(Ie["a"])(qe,Te,Ae,!1,null,null,null),Fe=ze.exports,Be=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"userList"},[n("h1",[e._v("帳號列表")]),n("div",{staticClass:"operationGroup"},[n("div",{staticClass:"operationGroup-left"},[e.deleteList.length?n("el-button",{attrs:{type:"primary"},on:{click:e.deleteUsers}},[e._v("刪除")]):e._e()],1),n("div",{staticClass:"operationGroup-right"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.toPath("UserCreate")}}},[n("i",{staticClass:"el-icon-plus"})])],1)]),n("el-table",{staticClass:"userList-table",attrs:{data:e.userList},on:{"selection-change":e.updateDeleteList}},[n("el-table-column",{attrs:{type:"selection",width:"40"}}),n("el-table-column",{attrs:{prop:"name",label:"姓名",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("h4",{staticClass:"clickable",on:{click:function(n){e.toPath("UserEdit",{userId:t.row.id})}}},[e._v("\n          "+e._s(t.row.name)+"\n        ")])]}}])}),n("el-table-column",{attrs:{prop:"company.name",label:"公司",width:"180"}}),n("el-table-column",{attrs:{prop:"roleName",label:"角色"}})],1)],1)},Je=[],Qe={name:"UserList",mixins:[we],data:function(){return{deleteList:[]}},computed:{userList:function(){return this.$store.getters.users}},methods:{deleteUsers:function(){var e=this;0!==this.deleteList.length&&this.$store.dispatch("deleteUsers",this.deleteList).then(function(){e.$message({message:"使用者 ".concat(e.deleteList," 已刪除"),type:"success",showClose:!0,center:!0,duration:1200})}).catch(function(t){e.$message.error("請重新檢查 ".concat(t.response.data.result))})},updateDeleteList:function(e){this.deleteList=e.map(function(e){return e.id})}}},He=Qe,Ye=Object(Ie["a"])(He,Be,Je,!1,null,null,null),Xe=Ye.exports,We=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"userCreate"},[n("h1",[e._v("帳號設定")]),n("h2",[e._v("基本資料")]),n("el-form",{attrs:{"label-position":"top","label-width":"80px",model:e.newUser}},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"姓名"}},[n("el-input",{model:{value:e.newUser.name,callback:function(t){e.$set(e.newUser,"name",t)},expression:"newUser.name"}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"角色"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"請選擇"},model:{value:e.selectedRole,callback:function(t){e.selectedRole=t},expression:"selectedRole"}},e._l(e.roles,function(e){return n("el-option",{key:e.name,attrs:{label:e.name,value:e.name}})}))],1)],1)],1),n("el-form-item",{attrs:{label:"帳號"}},[n("el-input",{model:{value:e.newUser.account,callback:function(t){e.$set(e.newUser,"account",t)},expression:"newUser.account"}}),n("h6",{staticClass:"hint",attrs:{type:"info"}},[e._v("預設密碼: 000")])],1),n("el-form-item",{attrs:{label:"公司名稱"}},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:17,sm:21,md:21}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"請選擇"},model:{value:e.selectedCompany,callback:function(t){e.selectedCompany=t},expression:"selectedCompany"}},e._l(e.companies,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),n("el-col",{attrs:{span:7,sm:3,md:3}},[n("el-button",{staticStyle:{width:"100%"},on:{click:e.saveCurrentAndGo}},[e._v("維護")])],1)],1)],1),e.isShow("account:soItemSelf")?n("el-form-item",{attrs:{label:"傾度管"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"請選擇"},model:{value:e.selectedSOItem,callback:function(t){e.selectedSOItem=t},expression:"selectedSOItem"}},e._l(e.soItems,function(e){return n("el-option",{key:e.id,attrs:{label:e.number,value:e.id}})}))],1):e._e(),n("el-form-item",[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:12}},[n("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.submit}},[e._v("\n            確定送出\n          ")])],1),n("el-col",{attrs:{span:12}},[n("el-button",{staticStyle:{width:"100%"},on:{click:e.cancel}},[e._v("\n            取消\n          ")])],1)],1)],1)],1)],1)},Ze=[],Ke=(n("7f7f"),{name:"UserCreate",mixins:[we],data:function(){return{selectedRole:"USER",selectedCompany:"",selectedSOItem:""}},computed:{userList:function(){return this.$store.getters.users},roles:function(){return this.$store.getters.roles},companies:function(){return this.$store.getters.companies},soItems:function(){return this.$store.getters.soItems.filter(function(e){return null===e.OPT})},user:function(){return this.$store.getters.currentUser},newUser:function(){return this.setSelectBox(),this.user}},methods:{cancel:function(){this.toPath("UserList")},submit:function(){var e=this;this.newUser.roleName=this.selectedRole,this.newUser.companyId=this.selectedCompany,this.newUser.soId=this.selectedSOItem,this.$store.dispatch("createUser",this.newUser).then(function(){e.$message({message:"成功新增 ".concat(e.newUser.name),type:"success",center:!0,duration:1800}),e.toPath("UserList")}).catch(function(t){e.$message.error("請重新檢查 ".concat(t.response.data.result))})},isShow:function(e){var t=this;return this.$store.getters.rolePermissions.filter(function(e){return e.role===t.selectedRole}).shift().permissions.filter(function(e){return e.value}).map(function(e){return e.name}).includes(e)},saveCurrentAndGo:function(){var e=this;this.newUser.roleName=this.selectedRole,this.newUser.companyId=this.selectedCompany,this.newUser.soId=this.selectedSOItem,this.$store.dispatch("updateCurrentUser",this.newUser).then(function(){e.toPath("CompanyList")})},setSelectBox:function(){this.selectedRole=this.user["roleName"]||"USER",this.selectedCompany=this.user["companyId"]||"",this.selectedSOItem=this.user["soId"]||""}}}),et=Ke,tt=(n("3ed4"),Object(Ie["a"])(et,We,Ze,!1,null,null,null)),nt=tt.exports,st=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"userEdit"},[n("h1",[e._v("帳號設定")]),n("h2",[e._v("基本資料")]),n("el-form",{attrs:{"label-position":"top","label-width":"80px",model:e.newUser}},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"姓名"}},[n("el-input",{model:{value:e.newUser.name,callback:function(t){e.$set(e.newUser,"name",t)},expression:"newUser.name"}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"角色"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"請選擇"},model:{value:e.selectedRole,callback:function(t){e.selectedRole=t},expression:"selectedRole"}},e._l(e.roles,function(e){return n("el-option",{key:e.name,attrs:{label:e.name,value:e.name}})}))],1)],1)],1),n("el-form-item",{attrs:{label:"帳號"}},[n("el-input",{attrs:{disabled:""},model:{value:e.newUser.account,callback:function(t){e.$set(e.newUser,"account",t)},expression:"newUser.account"}}),n("h4",{staticClass:"password"},[e._v("密碼："+e._s(e.newUser.password))])],1),n("el-form-item",{attrs:{label:"公司名稱"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"請選擇",disabled:""},model:{value:e.selectedCompany,callback:function(t){e.selectedCompany=t},expression:"selectedCompany"}},e._l(e.companies,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e.isShow("account:soItemSelf")?n("el-form-item",{attrs:{label:"傾度管"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"請選擇"},model:{value:e.selectedSOItem,callback:function(t){e.selectedSOItem=t},expression:"selectedSOItem"}},e._l(e.soItems,function(e){return n("el-option",{key:e.id,attrs:{label:e.number,value:e.id}})}))],1):e._e(),n("el-form-item",[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:12}},[n("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.edit}},[e._v("\n            確定送出\n          ")])],1),n("el-col",{attrs:{span:12}},[n("el-button",{staticStyle:{width:"100%"},on:{click:e.cancel}},[e._v("\n            取消\n          ")])],1)],1)],1)],1)],1)},at=[],ot={name:"UserEdit",mixins:[we],data:function(){return{selectedRole:"",selectedCompany:"",selectedSOItem:""}},computed:{userList:function(){return this.$store.getters.users},roles:function(){return this.$store.getters.roles},companies:function(){return this.$store.getters.companies},soItems:function(){return this.$store.getters.soItems.filter(function(e){return null===e.OPT})},user:function(){return this.$store.getters.currentUser},newUser:function(){return this.setSelectBox(),this.user}},methods:{cancel:function(){this.toPath("UserList")},edit:function(){var e=this,t={name:this.newUser.name,roleName:this.selectedRole,companyId:this.selectedCompany,account:this.newUser.account,soId:this.selectedSOItem};this.$store.dispatch("updateUser",{userId:this.$route.params.userId,payload:t}).then(function(){e.$message({message:"成功編輯 ".concat(t.name),type:"success",center:!0,duration:1800}),e.toPath("UserList")}).catch(function(t){e.$message.error("請重新檢查 ".concat(t.response.data.result))})},isShow:function(e){var t=this;return this.$store.getters.rolePermissions.filter(function(e){return e.role===t.selectedRole}).shift().permissions.filter(function(e){return e.value}).map(function(e){return e.name}).includes(e)},saveCurrentAndGo:function(){var e=this;this.newUser.roleName=this.selectedRole,this.newUser.company.id=this.selectedCompany,this.newUser.soItem={id:this.selectedSOItem},this.$store.dispatch("updateCurrentUser",this.newUser).then(function(){e.toPath("CompanyList")})},setSelectBox:function(){this.selectedRole=this.user.roleName,this.selectedCompany=this.user.company.id,this.selectedSOItem=this.user.soItem?this.user.soItem.id:""}}},rt=ot,it=(n("3630"),Object(Ie["a"])(rt,st,at,!1,null,"26a36aea",null)),ct=it.exports,lt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"companyList"},[n("h1",[e._v("公司列表")]),n("el-row",{staticClass:"operationGroup",attrs:{type:"flex",justify:"between"}},[n("el-col",{staticClass:"operationGroup-left",attrs:{sm:4}},[e.deleteList.length?n("el-button",{attrs:{type:"primary"},on:{click:e.deleteCompanies}},[e._v("刪除")]):e._e()],1),n("el-col",{staticClass:"operationGroup-right",attrs:{span:24,sm:8}},[n("el-input",{attrs:{placeholder:"新增公司名稱"},model:{value:e.newCompany.name,callback:function(t){e.$set(e.newCompany,"name",t)},expression:"newCompany.name"}}),e.newCompany.name?n("el-button",{staticClass:"addButton",attrs:{type:"primary"},on:{click:e.createCompany}},[n("i",{staticClass:"el-icon-plus"})]):e._e()],1)],1),n("el-table",{staticClass:"companyList-table",attrs:{data:e.companyList},on:{"selection-change":e.updateDeleteList}},[n("el-table-column",{attrs:{type:"selection",width:"40"}}),n("el-table-column",{attrs:{prop:"name",label:"公司名稱"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{on:{blur:function(n){e.editCompany(t.row.id,t.row.name)}},model:{value:t.row.name,callback:function(n){e.$set(t.row,"name",n)},expression:"scope.row.name"}})]}}])})],1)],1)},ut=[],dt={name:"companyList",mixins:[we],data:function(){return{deleteList:[],newCompany:{name:""}}},computed:{companyList:function(){return JSON.parse(JSON.stringify(this.$store.getters.companies))}},methods:{createCompany:function(){this.$store.dispatch("createCompany",{name:this.newCompany.name})},deleteCompanies:function(){var e=this;0!==this.deleteList.length&&this.$store.dispatch("deleteCompanies",this.deleteList).then(function(){e.$message({message:"成功刪除 ".concat(e.deleteList),type:"success",center:!0,duration:1800})}).catch(function(t){e.$message.error("請重新檢查 ".concat(t.response.data.result))})},updateDeleteList:function(e){this.deleteList=e.map(function(e){return e.id})},editCompany:function(e,t){var n=this;t!==this.$store.getters.companies.filter(function(t){return t.id==e})[0].name&&this.$store.dispatch("updateCompany",{companyId:e,payload:{name:t}}).then(function(){n.$message({message:"成功編輯 ".concat(n.newName),type:"success",center:!0,duration:1800})}).catch(function(e){n.$message.error("請重新檢查 ".concat(e.response.data.result))})}}},mt=dt,pt=Object(Ie["a"])(mt,lt,ut,!1,null,null,null),ht=pt.exports,ft=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"permission-setup"},[n("h1",[e._v("權限設定")]),n("el-table",{attrs:{data:e.rolePermissions}},[n("el-table-column",{attrs:{prop:"role",label:"角色",width:"140"}}),n("el-table-column",{attrs:{prop:"permissions",label:"權限"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.permissions,function(s,a){return n("div",{key:a},["account:updateSelf"!==s.name?n("el-checkbox",{attrs:{value:s.value},on:{change:function(n){e.updateRolePermissions(s.value,t.row.role,a)}}},[e._v("\n            "+e._s(e.permissions[s.name])+"\n          ")]):e._e()],1)})}}])})],1),n("div",{staticClass:"button-container"},[n("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("\n      確認送出\n    ")]),n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.toPath("ProjectList")}}},[e._v("\n      取消修改\n    ")])],1)],1)},gt=[],bt={name:"PermissionSetup",mixins:[we],data:function(){return{}},computed:{permissions:function(){return this.$store.getters.permissions},rolePermissions:function(){return this.$store.getters.rolePermissions}},methods:{updateRolePermissions:function(e,t,n){e=!e,this.$store.commit("updateRolePermissions",{role:t,permissionIndex:n,value:e})},submit:function(){var e=this;this.$store.dispatch("updateRolePermissions").then(function(){e.$message({message:"權限設定成功 請重新登入",type:"success"}),e.toPath("ProjectList")}).catch(function(t){e.$message.error(t,"權限設定失敗")})}}},vt=bt,wt=Object(Ie["a"])(vt,ft,gt,!1,null,null,null),jt=wt.exports,yt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"projectSetting"},[n("h1",[e._v("專案設定")]),n("div",{staticClass:"operationGroup"},[n("div",{staticClass:"operationGroup-left"},[n("el-button",{directives:[{name:"show",rawName:"v-show",value:!!e.deleteList.length,expression:"!!deleteList.length"}],attrs:{type:"primary"},on:{click:e.deleteProjects}},[e._v("刪除")])],1),n("div",{staticClass:"operationGroup-right"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.toPath("ProjectCreate")}}},[n("i",{staticClass:"el-icon-plus"})])],1)]),n("el-table",{staticClass:"projectList-table",attrs:{data:e.projectList},on:{"selection-change":e.updateDeleteList}},[n("el-table-column",{attrs:{type:"selection",width:"40"}}),n("el-table-column",{attrs:{label:"案號",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("h4",{staticClass:"clickable",on:{click:function(n){e.toPath("ProjectEdit",{projectId:t.row.id})}}},[e._v("\n          "+e._s(t.row.number)+"\n        ")])]}}])}),n("el-table-column",{attrs:{prop:"name",label:"名稱",width:"150"}}),n("el-table-column",{attrs:{prop:"status",label:"專案狀態",filters:e.statusList,"filter-method":e.statusFilter},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-tag",{attrs:{type:"end"===t.row.status?"success":"warning","disable-transitions":""}},[e._v(e._s(t.row.status))])]}}])})],1)],1)},Pt=[],St={name:"ProjectSetting",mixins:[we],data:function(){return{deleteList:[],statusList:[{text:"結案",value:"end"},{text:"執行",value:"in-progress"}]}},computed:{projectList:function(){return this.$store.getters.projects}},methods:{deleteProjects:function(){var e=this;0!==this.deleteList.length&&this.$store.dispatch("deleteProjects",this.deleteList).then(function(){var t=e.idToName(e.projectList,e.deleteList);e.$message({message:"成功刪除 ".concat(t),type:"success",center:!0,duration:1800})}).catch(function(t){e.$message.error("請重新檢查 ".concat(t.response.data.result))})},updateDeleteList:function(e){this.deleteList=e.map(function(e){return e.id})},statusFilter:function(e,t){return t.status===e},idToName:function(e,t){return e.filter(function(e){return t.includes(e.id)}).map(function(e){return e.name})}}},_t=St,It=Object(Ie["a"])(_t,yt,Pt,!1,null,null,null),kt=It.exports,Ct=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"projectList"},[n("h1",[e._v("專案列表")]),e.isShow("project:filter")?n("el-select",{staticClass:"status-filter",attrs:{multiple:"",placeholder:"請篩選"},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},e._l(e.options,function(e){return n("el-option",{key:e.value,attrs:{label:e.text,value:e.value}})})):e._e(),n("el-table",{staticClass:"projectList-table",attrs:{data:e.filteredProject,height:"550px"}},[n("el-table-column",{attrs:{fixed:"",prop:"number",label:"案號",width:"120"}}),n("el-table-column",{attrs:{prop:"name",label:"名稱",width:"160"}}),n("el-table-column",{attrs:{label:"監控資料",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{on:{click:function(n){e.toPath("ProjectMonitor",{projectId:t.row.id})}}},[e._v("進入檢視")])]}}])}),e.isShow("project:soItemMeasure")?n("el-table-column",{attrs:{label:"傾度管量測",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{on:{click:function(n){e.to(t.row.id)}}},[e._v("進入測量")])]}}])}):e._e(),e.isShow("project:filter")?n("el-table-column",{attrs:{prop:"status",label:"專案狀態",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-tag",{attrs:{type:"end"===t.row.status?"success":"warning","disable-transitions":""}},[e._v(e._s(t.row.status))])]}}])}):e._e()],1)],1)},xt=[],Ot={name:"ProjectList",mixins:[we],data:function(){return{deleteList:[],options:[{text:"結案",value:"end"},{text:"執行",value:"in-progress"}],status:["in-progress"]}},computed:{projectList:function(){return this.$store.getters.projects},filteredProject:function(){var e=this;return this.projectList.filter(function(t){return 0!==e.status.length&&(1===e.status.length?t.status===e.status[0]:2===e.status.length?t:void 0)})}},methods:{to:function(e){window.location="http://".concat(window.location.host,"/measures/so/").concat(e)},deleteProjects:function(){var e=this;0!==this.deleteList.length&&this.$store.dispatch("deleteProjects",this.deleteList).then(function(){e.$message({message:"專案 ".concat(e.deleteList," 已刪除"),type:"success",showClose:!0,center:!0,duration:1200})}).catch(function(t){e.$message.error("請重新檢查 ".concat(t.response.data.result))})},updateDeleteList:function(e){this.deleteList=e.map(function(e){return e.id})},statusFilter:function(e,t){return t.status===e},isShow:function(e){return!!this.$store.getters.myPermissions&&this.$store.getters.myPermissions.includes(e)}}},Mt=Ot,Lt=(n("2f92"),Object(Ie["a"])(Mt,Ct,xt,!1,null,null,null)),$t=Lt.exports,Dt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"createProject"},[n("h1",[e._v("專案設定")]),n("el-form",{ref:"newProject",attrs:{"label-position":"top","label-width":"80px",model:e.newProject,rules:e.rules}},[n("h2",[e._v("基本資料")]),n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"專案案號",prop:"number"}},[n("el-input",{attrs:{placeholder:"請輸入專案號"},model:{value:e.newProject.number,callback:function(t){e.$set(e.newProject,"number",t)},expression:"newProject.number"}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"專案狀態",prop:"status"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"請選擇"},model:{value:e.newProject.status,callback:function(t){e.$set(e.newProject,"status",t)},expression:"newProject.status"}},e._l(e.statusList,function(e){return n("el-option",{key:e.name,attrs:{label:e.label,value:e.value}})}))],1)],1)],1),n("el-row",{attrs:{gutter:20}},[n("el-col",[n("el-form-item",{attrs:{label:"專案名稱",prop:"name"}},[n("el-input",{attrs:{placeholder:"阡福町商業大樓"},model:{value:e.newProject.name,callback:function(t){e.$set(e.newProject,"name",t)},expression:"newProject.name"}})],1)],1)],1),n("el-form-item",{attrs:{label:"地點",prop:"address"}},[n("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"請輸入地址"},model:{value:e.newProject.address,callback:function(t){e.$set(e.newProject,"address",t)},expression:"newProject.address"}})],1),n("el-form-item",{attrs:{label:"客戶公司名稱"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"請選擇公司名稱"},on:{change:e.updateSelectedCompany},model:{value:e.selectedCompany,callback:function(t){e.selectedCompany=t},expression:"selectedCompany"}},e._l(e.companiesList,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),n("h2",[e._v("參與人員")]),n("el-tabs",{attrs:{type:"border-card",stretch:""}},[n("el-tab-pane",{attrs:{label:"OPT"}},[n("el-form-item",[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"請選擇 OPT",multiple:""},on:{change:e.updateSelectedOPTs},model:{value:e.selectedOPTs,callback:function(t){e.selectedOPTs=t},expression:"selectedOPTs"}},e._l(e.OPTList,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),n("el-tab-pane",{attrs:{label:"USER"}},[n("el-form-item",[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"請選擇 USER",multiple:""},on:{change:e.updateSelectedUSERs},model:{value:e.selectedUSERs,callback:function(t){e.selectedUSERs=t},expression:"selectedUSERs"}},e._l(e.USERList,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1)],1),n("h1",[e._v("配置圖")]),n("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:"uploadURL","on-change":e.getImage,"list-type":"picture","before-upload":e.beforeImgUpload,"auto-upload":!0}},[e.imageSelected?n("img",{attrs:{src:e.image,alt:""}}):e._e(),e.imageSelected?e._e():n("i",{staticClass:"el-icon-upload"}),e.imageSelected?e._e():n("div",{staticClass:"el-upload__text"},[e._v("\n        將文件拖到此處，或"),n("em",[e._v("點擊上傳")])]),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("上傳文件不能超過2Mb")]),e.imageSelected?n("el-button",{staticClass:"reselect",attrs:{size:"small",type:"primary"}},[e._v("另選圖片")]):e._e()],1),n("h2",[e._v("監控設定")]),n("el-tabs",{attrs:{type:"border-card",stretch:""}},[n("el-tab-pane",{attrs:{label:"軸力計 ( VG )"}},[n("el-form-item",{attrs:{label:"使用軸力計編號",prop:"vgIds"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"可複選",multiple:""},on:{change:e.updateSelectedVGs},model:{value:e.newProject.vgIds,callback:function(t){e.$set(e.newProject,"vgIds",t)},expression:"newProject.vgIds"}},e._l(e.VGs,function(t){return n("el-option",{key:t.id,attrs:{disabled:e.disableVG(t.projectName),label:t.number,value:t.id}})})),e.isEnoughtVG?e._e():n("h3",[e._v("請增加軸力計")])],1),n("el-form-item",{attrs:{label:"支撐階數：",prop:"floor"}},[n("el-input",{attrs:{placeholder:"3"},nativeOn:{keyup:function(t){e.fullVGsInfo=[]}},model:{value:e.newProject.floor,callback:function(t){e.$set(e.newProject,"floor",e._n(t))},expression:"newProject.floor"}})],1),n("el-form-item",{attrs:{label:"每層數量：",required:""}},[n("el-input",{attrs:{placeholder:"5"},nativeOn:{keyup:function(t){e.fullVGsInfo=[]}},model:{value:e.numOfFloor,callback:function(t){e.numOfFloor=e._n(t)},expression:"numOfFloor"}})],1),n("br"),n("el-button",{attrs:{disabled:!e.preparedShowVG},nativeOn:{click:function(t){e.getVGItems()}}},[e._v("請產生軸力計編碼")]),n("br"),n("br"),e.fullVGsInfo.length?n("div",{staticClass:"block"},[n("span",{staticClass:"demonstration"},[e._v("請選擇支撐階數")]),n("el-pagination",{attrs:{layout:"prev, pager, next",total:e.getPagination},on:{"current-change":e.currentFloor}})],1):e._e(),e.fullVGsInfo.length?n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:5}},[n("h2",[e._v("管理值"),n("span",[e._v("單位：噸")])]),n("el-form-item",{attrs:{label:"注意值",prop:"vgManagement["+this.floorIndex+"].notice",rules:[{required:!0,message:"請檢查注意值",trigger:["blur","change"]},{pattern:/^\d+(\.\d{0,1})?$/,message:"小數點下最多一位 0.1",trigger:["blur","change"]}]}},[n("el-input",{attrs:{size:"mini",placeholder:"68.3"},model:{value:e.newProject.vgManagement[e.floorIndex].notice,callback:function(t){e.$set(e.newProject.vgManagement[e.floorIndex],"notice",t)},expression:"newProject.vgManagement[floorIndex].notice"}})],1),n("el-form-item",{attrs:{label:"警戒值",prop:"vgManagement["+this.floorIndex+"].warning",rules:[{required:!0,message:"請檢查警戒值",trigger:["blur","change"]},{pattern:/^\d+(\.\d{0,1})?$/,message:"小數點下最多一位 0.1",trigger:["blur","change"]}]}},[n("el-input",{attrs:{size:"mini",placeholder:"79.6"},model:{value:e.newProject.vgManagement[e.floorIndex].warning,callback:function(t){e.$set(e.newProject.vgManagement[e.floorIndex],"warning",t)},expression:"newProject.vgManagement[floorIndex].warning"}})],1),n("el-form-item",{attrs:{label:"行動值",prop:"vgManagement["+this.floorIndex+"].action",rules:[{required:!0,message:"請檢查行動值",trigger:["blur","change"]},{pattern:/^\d+(\.\d{0,1})?$/,message:"小數點下最多一位 0.1",trigger:["blur","change"]}]}},[n("el-input",{attrs:{size:"mini",placeholder:"104.2"},model:{value:e.newProject.vgManagement[e.floorIndex].action,callback:function(t){e.$set(e.newProject.vgManagement[e.floorIndex],"action",t)},expression:"newProject.vgManagement[floorIndex].action"}})],1)],1),n("el-col",{attrs:{span:19}},[n("h2",[e._v("位置編碼"),n("span",[e._v("( VG - 層數 - 流水號 )")])]),n("el-button",{on:{click:function(t){e.toPath("SteelList")}}},[e._v("\n              維護鋼材資料\n            ")]),n("el-table",{staticClass:"vg-table",attrs:{data:e.vgTable}},[n("el-table-column",{attrs:{prop:"host.number",label:"VG",width:"120"}}),n("el-table-column",{attrs:{prop:"port",label:"Port",width:"80"}}),n("el-table-column",{attrs:{prop:"serial",label:"編碼",width:"100"}}),n("el-table-column",{attrs:{prop:"steelId",label:"鋼材",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-select",{attrs:{placeholder:"請選擇鋼材"},model:{value:t.row.steelId,callback:function(n){e.$set(t.row,"steelId",n)},expression:"scope.row.steelId"}},e._l(e.Steels,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))]}}])})],1)],1)],1):e._e()],1),n("el-tab-pane",{attrs:{label:"傾度管 ( SO )"}},[n("el-form-item",{attrs:{label:"數量：",prop:"vgAction"}},[n("el-input",{attrs:{placeholder:"5"},nativeOn:{keyup:function(t){e.newProject.soLocation=[]}},model:{value:e.soQt,callback:function(t){e.soQt=e._n(t)},expression:"soQt"}})],1),n("el-form-item",{attrs:{label:"每孔深度 ( m )：",prop:"vgAction"}},[n("el-input",{attrs:{placeholder:"20.5"},nativeOn:{keyup:function(t){e.newProject.soLocation=[]}},model:{value:e.soDepth,callback:function(t){e.soDepth=e._n(t)},expression:"soDepth"}})],1),n("br"),n("el-button",{attrs:{disabled:!e.preparedShowSO},nativeOn:{click:function(t){e.getSOItems()}}},[e._v("產生傾度管編碼")]),n("br"),e.newProject.soLocation.length?n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:8}},[n("h2",[e._v("管理值"),n("span",[e._v("單位：cm")])]),n("el-form-item",{attrs:{label:"注意值",prop:"soManagement.notice"}},[n("el-input",{attrs:{controls:!1,placeholder:"1.68"},model:{value:e.newProject.soManagement.notice,callback:function(t){e.$set(e.newProject.soManagement,"notice",t)},expression:"newProject.soManagement.notice"}})],1),n("el-form-item",{attrs:{label:"警戒值",prop:"soManagement.warning"}},[n("el-input",{attrs:{controls:!1,placeholder:"2.88"},model:{value:e.newProject.soManagement.warning,callback:function(t){e.$set(e.newProject.soManagement,"warning",t)},expression:"newProject.soManagement.warning"}})],1),n("el-form-item",{attrs:{label:"行動值",prop:"soManagement.action"}},[n("el-input",{attrs:{controls:!1,placeholder:"3.77"},model:{value:e.newProject.soManagement.action,callback:function(t){e.$set(e.newProject.soManagement,"action",t)},expression:"newProject.soManagement.action"}})],1)],1),n("el-col",{attrs:{span:14}},[n("h2",[e._v("位置編號"),n("span",[e._v("( SO - 流水號 )")])]),n("h5",[e._v("相同位置編碼 量測深度間隔 1 m")]),n("el-table",{staticClass:"so-table",attrs:{data:e.newProject.soLocation}},[n("el-table-column",{attrs:{prop:"number",label:"編碼",width:"200"}}),n("el-table-column",{attrs:{prop:"depth",label:"深度",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{model:{value:t.row.depth,callback:function(n){e.$set(t.row,"depth",e._n(n))},expression:"scope.row.depth"}})]}}])})],1)],1)],1):e._e()],1)],1),n("br"),n("el-form-item",[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:12}},[n("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",disabled:0===this.fullVGsInfo.length},on:{click:function(t){e.submit("newProject")}}},[e._v("\n            確定送出\n          ")])],1),n("el-col",{attrs:{span:12}},[n("el-button",{staticStyle:{width:"100%"},on:{click:e.cancel}},[e._v("\n            取消\n          ")])],1)],1)],1)],1)],1)},Gt=[],Et=(n("1c4c"),n("6c7b"),{methods:{importVGItems:function(e,t,n){var s=[],a=function(){for(var s=e*t,a=s%n.length,o=Math.floor(s/n.length),r=new Array(n.length).fill(o),i=0;i<a;i++)r[i]+=1;return r}();function o(e){return Array.from({length:e},function(e,t){return t+1})}function r(e,t){return new Array(e).fill(n[t])}function i(e){var t=[];return a.forEach(function(n,s){var a=e(n,s);t=t.concat(a)}),t}var c=i(o),l=i(r);function u(t,n){var s=n.filter(function(n,s){if(s%e==t)return n});return s}function d(t){for(var n=[],s=0;s<e;s++)n.push(u(s,t));return n}var m=d(l),p=d(c);function h(){for(var e=m.flat(),n=p.flat(),a=0,o=0;o<e.length;o++)o%t==0&&(a+=1),s[o]={floor:a,host:e[o],port:n[o],serial:"vg-".concat(a,"-0").concat(o%t+1),steelId:""}}return h(),s}}}),Vt=Et,Ut=n("bc3a"),Rt=n.n(Ut),Tt=(n("f751"),n("2f62")),At=n("2b27"),Nt=n.n(At);pe["default"].use(Nt.a);var qt={saveLogin:function(){Nt.a.set("token",nn.getters.token),Nt.a.set("userId",nn.getters.myId),Nt.a.set("role",nn.getters.myRole),Nt.a.set("permissions",nn.getters.myPermissions)},reloadLogin:function(){nn.commit("setToken",Nt.a.get("token")),nn.commit("setMyId",Nt.a.get("userId")),nn.commit("setMyRole",Nt.a.get("role")),nn.commit("setMyPermissions",Nt.a.get("permissions"))},clear:function(){Nt.a.set("token",null),Nt.a.set("userId",null),Nt.a.set("role",null),Nt.a.set("permissions",null),Nt.a.remove("token"),Nt.a.remove("userId"),Nt.a.remove("role"),Nt.a.remove("permissions")}},zt=function(e,t,n,s){var a={Accept:"application/json"};n&&(a["x-access-token"]=nn.getters.token);var o={baseURL:"https://geo-stage.chuen.com.tw:3333/v1",headers:a};return Rt.a.create(o)[e](t,s).catch(function(e){var t=e.response.data.result,n=e.message;return("jwt expired"===t||"invalid token"===t||n)&&nn.dispatch("logout"),Promise.reject(e)})},Ft={state:{data:[],currentOne:{}},mutations:{setUsers:function(e,t){e.data=t},setUser:function(e,t){e.currentOne=t}},getters:{users:function(e){return e.data},currentUser:function(e){return e.currentOne},OPTs:function(e){return e.data.filter(function(e){return"OPT"==e.roleName})},USERs:function(e){return e.data.filter(function(e){return"USER"==e.roleName})}},actions:{getUser:function(e,t){var n=e.commit;return zt("get","/user/".concat(t),!0).then(function(e){n("setUser",e.data.data)})},updateCurrentUser:function(e,t){var n=e.commit;n("setUser",t)},updateUser:function(e,t){var n=t.userId,s=t.payload;return zt("put","/user/".concat(n),!0,s)},getUsers:function(e){var t=e.commit;return zt("get","/users",!0).then(function(e){t("setUsers",e.data.data)})},deleteUsers:function(e,t){var n=e.dispatch,s=t.join(",");return zt("delete","/users/".concat(s),!0).then(function(){n("getUsers")})},createUser:function(e,t){return zt("post","/user",!0,t)}}},Bt={state:{data:[],one:{}},mutations:{setProjects:function(e,t){e.data=t},setProject:function(e,t){e.one=t},updateConfigImage:function(e,t){e.one.sitePlan=t}},getters:{projects:function(e){return e.data},currentProject:function(e){return e.one}},actions:{getProject:function(e,t){var n=e.commit;return zt("get","/project/".concat(t),!0).then(function(e){n("setProject",e.data.data)})},updateCurrentProject:function(e,t){var n=e.commit;n("setProject",t)},updateProject:function(e,t){var n=t.projectId,s=t.payload;return zt("put","/project/".concat(n),!0,s)},getProjects:function(e){var t=e.commit;return zt("get","/projects",!0).then(function(e){t("setProjects",e.data.data)})},deleteProjects:function(e,t){var n=e.dispatch,s=t.join(",");return zt("delete","/projects/".concat(s),!0).then(function(){n("getProjects")})},createProject:function(e,t){return zt("post","/project",!0,t)},uploadConfigImage:function(e,t){var n=e.commit;return sn(t).then(function(e){n("updateConfigImage",e.data.url)})}}},Jt={state:{data:[]},mutations:{setProjectPhases:function(e,t){e.data=t}},getters:{projectPhases:function(e){return e.data}},actions:{getProjectPhases:function(e){var t=e.commit;return zt("get","/project-phases",!0).then(function(e){t("setProjectPhases",e.data.data)})},getProjectPhase:function(e,t){return zt("get","/project-phase/".concat(t),!0)},updateProjectPhase:function(e,t){var n=t.projectPhaseId,s=t.payload;return zt("put","/project-phased/".concat(n),!0,s)},deleteProjectPhases:function(e,t){var n=e.dispatch,s=t.join(",");return zt("delete","/project-phases/".concat(s),!0).then(function(){n("getProjectPhases")})},createProjectPhase:function(e,t){return zt("post","/project-phased",!0,t)}}},Qt={state:{data:[]},mutations:{setCompanies:function(e,t){e.data=t}},getters:{companies:function(e){return e.data}},actions:{getCompanies:function(e){var t=e.commit;return zt("get","/companies",!0).then(function(e){t("setCompanies",e.data.data)})},createCompany:function(e,t){var n=e.dispatch;return zt("post","/company",!0,t).then(function(){n("getCompanies")})},deleteCompanies:function(e,t){var n=e.dispatch,s=t.join(",");return zt("delete","/companies/".concat(s),!0).then(function(){n("getCompanies")})},updateCompany:function(e,t){var n=t.companyId,s=t.payload;return zt("put","/company/".concat(n),!0,s)}}},Ht={getVGs:function(e){var t=e.commit;return zt("get","/vgs",!0).then(function(e){t("setVGs",e.data.data)})},deleteVGs:function(e,t){var n=e.dispatch,s=t.join(",");return zt("delete","/vgs/".concat(s),!0).then(function(){n("getVGs")})},createVG:function(e,t){return zt("post","/vg",!0,t)},updateVG:function(e,t){var n=t.vgId,s=t.payload;return zt("put","/vg/".concat(n),!0,s)},exportVG:function(e,t){return zt("get","/measures/vg/export?projectId=".concat(t),!0)}},Yt={actions:Ht,state:{data:[]},mutations:{setVGs:function(e,t){e.data=t}},getters:{vgs:function(e){return e.data}}},Xt={state:{data:[]},mutations:{setSteels:function(e,t){e.data=t}},getters:{steels:function(e){return e.data}},actions:{getSteels:function(e){var t=e.commit;return zt("get","/steels",!0).then(function(e){t("setSteels",e.data.data)})},createSteel:function(e,t){return zt("post","/steel",!0,t)},deleteSteels:function(e,t){var n=e.dispatch,s=t.join(",");return zt("delete","/steels/".concat(s),!0).then(function(){n("getSteels")})},updateSteel:function(e,t){var n=t.steelId,s=t.payload;return zt("put","/steel/".concat(n),!0,s)}}},Wt={state:{tempFormulaParameter:[37.7705,137.7711,161.2568,131.165,54.3038,9.3219]},getters:{getSO_C:function(e){return e.SO_C},getTempFormulaParameter:function(e){return e.tempFormulaParameter}},mutations:{setSO_C:function(e,t){e.SO_C=t},setTempFormulaParameter:function(e,t){e.tempFormulaParameter=t}},actions:{uploadMeasuresDatas:function(e,t){return zt("post","/measures/so",!0,t)}}},Zt={state:{data:[]},mutations:{setSOItems:function(e,t){e.data=t}},getters:{soItems:function(e){return e.data}},actions:{deleteSOItems:function(e,t){var n=e.dispatch,s=t.join(",");return zt("delete","/so-items/".concat(s),!0).then(function(){n("getSOItems")})},getSOItem:function(e,t){return zt("get","/so-item/".concat(t),!0)},updateSOItem:function(e,t){var n=t.soId,s=t.payload;return zt("put","/so-item/".concat(n),!0,s)},getSOItems:function(e){var t=e.commit;return zt("get","/so-items",!0).then(function(e){t("setSOItems",e.data.data)})},createSOItem:function(e,t){return zt("post","/so-item",!0,t)},exportSO:function(e,t){return zt("get","/measures/so/export?projectId=".concat(t),!0)}}},Kt={state:{data:[]},mutations:{setSOModels:function(e,t){e.data=t}},getters:{soModels:function(e){return e.data}},actions:{getSOModels:function(e){var t=e.commit;return zt("get","so-models",!0).then(function(e){t("setSOModels",e.data.data)})}}},en={fetchVgMeasuredData:function(e,t){var n=e.commit,s=t.projectId,a=t.date,o=t.floor;return zt("get","/measures/vg?projectId=".concat(s,"&date=").concat(a,"&floor=").concat(o),!0).then(function(e){return e.data.data}).then(function(e){n("vgMeasuredData",e)})},fetchSoMeasuredData:function(e,t){var n=e.commit,s=t.projectId,a=t.locationNumber;return zt("get","/measures/so?projectId=".concat(s,"&soLocationNumber=").concat(a),!0).then(function(e){return e.data.data}).then(function(e){return n("soMeasuredData",e)})}},tn={state:{vgMeasuredData:[],soMeasuredData:[]},mutations:{vgMeasuredData:function(e,t){e.vgMeasuredData=t},soMeasuredData:function(e,t){e.soMeasuredData=t}},getters:{vgMeasuredData:function(e){return e.vgMeasuredData},dateOfSoMeasuredData:function(e){return e.soMeasuredData.map(function(e){return e.date})},soMeasuredData:function(e){return e.soMeasuredData}},actions:en};pe["default"].use(Tt["a"]);var nn=new Tt["a"].Store({modules:{users:Ft,projects:Bt,projectPhases:Jt,companies:Qt,vgs:Yt,steels:Xt,measureSO:Wt,soItems:Zt,soModels:Kt,projectMonitor:tn},state:{myId:"",token:"",myRole:"",myPermissions:"",me:{},permissions:{},roles:[],rolePermissions:[],companies:[],soItems:[],lastPath:""},mutations:{setToken:function(e,t){e.token=t},setMyId:function(e,t){e.myId=t},setMyRole:function(e,t){e.myRole=t},setMyPermissions:function(e,t){e.myPermissions=t},setLastPath:function(e,t){e.lastPath=t},setMe:function(e,t){e.me=t},updateMe:function(e,t){e.me=Object.assign(e.me,t)},setPermissions:function(e,t){e.permissions=t},setRoles:function(e,t){e.roles=t},setRolePermissions:function(e,t){e.rolePermissions=t},updateRolePermissions:function(e,t){var n=t.value,s=t.role,a=t.permissionIndex;e.rolePermissions=e.rolePermissions.map(function(e){return e.role===s&&(e.permissions[a].value=n),e})}},getters:{isLogined:function(e){return!!(e.token&&e.myId&&e.myRole&&e.myPermissions)},token:function(e){return e.token},myId:function(e){return e.myId},myRole:function(e){return e.myRole},myPermissions:function(e){return e.myPermissions},lastPath:function(e){return e.lastPath},me:function(e){return e.me},myCompany:function(e){return e.me.company},permissions:function(e){return e.permissions},roles:function(e){return e.roles},rolePermissions:function(e){return e.rolePermissions}},actions:{login:function(e,t){var n=e.commit;return zt("post","/login",!1,t).then(function(e){n("setToken",e.data.token),n("setMyId",e.data.userId),n("setMyRole",e.data.role),n("setMyPermissions",e.data.permissions),qt.saveLogin()})},logout:function(e){var t=e.commit;t("setToken",""),qt.clear(),Fs.push("/")},getMe:function(e){var t=e.getters,n=e.commit;return zt("get","/user/".concat(t.myId),!0).then(function(e){n("setMe",e.data.data)})},updateMe:function(e){var t=e.state;return zt("put","/user/self",!0,t.me)},getRoles:function(e){var t=e.commit;return zt("get","/roles",!0).then(function(e){t("setRoles",e.data.data)})},getPermissions:function(e){var t=e.commit;return zt("get","/permissions",!0).then(function(e){t("setPermissions",e.data.data)})},getRolesPermissions:function(e){var t=e.commit;return zt("get","/role/permissions",!0).then(function(e){t("setRolePermissions",e.data.data)})},updateRolePermissions:function(e){var t=e.state;return zt("put","/role/permissions",!0,t.rolePermissions)}}}),sn=function(e){var t=new FormData;t.append("img",e);var n="https://geo-stage.chuen.com.tw:3333/v1/uploadImg";return Rt.a.post(n,t,{headers:{"Content-Type":"multipart/form-data","x-access-token":nn.getters.token}})},an={name:"ProjectCreate",mixins:[we,Vt],data:function(){return{soQt:0,soDepth:0,floorIndex:0,numOfFloor:0,VGList:[],vgTable:[],fullVGsInfo:[],OPTList:[],USERList:[],selectedCompany:"",selectedOPTs:[],selectedUSERs:[],image:"",statusList:[{value:"end",label:"結案"},{value:"in-progress",label:"執行"}],newProject:{number:"",status:"in-progress",name:"",address:"",companyId:"",sitePlan:"",OPT:[],USER:[],floor:1,vgManagement:[],soManagement:{notice:"",warning:"",action:""},vgIds:[],vgLocation:[],soLocation:[]},rules:{number:[{required:!0,message:"請輸入編號",trigger:["blur","change"]},{min:3,max:12,message:"長度在 3 到 12 個字元",trigger:["blur","change"]}],name:{required:!0,message:"請輸入專案名稱",trigger:["blur","change"]},vgIds:{required:!0,message:"請選擇軸力計",trigger:["blur","change"]},floor:{required:!0,message:"請選擇層數",trigger:["blur","change"]},"soManagement.notice":[{required:!0,message:"請輸入注意值",trigger:["blur","change"]},{pattern:/^\d(\.\d{0,2})?$/,message:"數字格式為 x.xx",trigger:["blur","change"]}],"soManagement.warning":[{required:!0,message:"請輸入警戒值",trigger:["blur","change"]},{pattern:/^\d(\.\d{0,2})?$/,message:"數字格式為 x.xx",trigger:["blur","change"]}],"soManagement.action":[{required:!0,message:"請輸入行動值",trigger:["blur","change"]},{pattern:/^\d(\.\d{0,2})?$/,message:"數字格式為 x.xx",trigger:["blur","change"]}]}}},watch:{selectedCompany:function(e){var t=this,n=this.$store.getters.OPTs,s=n.filter(function(t){return t.company.id==e}),a=n.filter(function(e){return e.company.id==t.myCompany.id});this.OPTList=a.concat(s);var o=this.$store.getters.USERs,r=o.filter(function(t){return t.company.id==e});this.USERList=r}},computed:{companiesList:function(){var e=this,t=this.$store.getters.companies;return t.filter(function(t){return t.id!=e.myCompany.id})},myCompany:function(){return this.$store.getters.myCompany},uploadURL:function(){return"".concat("https://geo-stage.chuen.com.tw:3333/v1","/uploads")},VGs:function(){return this.$store.getters.vgs},isEnoughtVG:function(){var e=this.newProject.floor*this.numOfFloor,t=14*this.VGList.length;return t>=e},preparedShowVG:function(){var e=!!this.newProject.floor,t=!!this.numOfFloor,n=0!==this.newProject.vgIds.length,s=e&&t&&n;return s&&this.isEnoughtVG},getPagination:function(){return 10*this.newProject.floor},Steels:function(){return this.$store.getters.steels},preparedShowSO:function(){return!!this.soQt&&!!this.soDepth},imageSelected:function(){return this.newProject.sitePlan}},methods:{reset:function(){this.newProject={number:"",status:"",name:"",address:"",companyId:"",sitePlan:"",OPT:[],USER:[],floor:0,vgManagement:[{notice:0,warning:0,action:0}],soManagement:{notice:0,warning:0,action:0},vgIds:[],vgLocation:[],soLocation:[]}},cancel:function(){this.reset(),this.toPath("ProjectSetting")},submit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$message.error("請重新檢查必填欄位"),!1;t.createProject()})},createProject:function(){var e=this;this.strToNumArrayObject(this.newProject.vgManagement),this.strToNumObject(this.newProject.soManagement),this.initVGLocation(),this.mergeVGLocation(this.newProject.vgLocation,this.fullVGsInfo),this.$store.dispatch("createProject",this.newProject).then(function(){e.reset(),e.$message({message:"成功新增 ".concat(e.newProject.name),type:"success",center:!0,duration:1800}),e.toPath("ProjectSetting")}).catch(function(t){"number must be unique"===t.response.data.result?e.$message.error("請重新檢查 案號重複"):e.$message.error("請重新檢查 ".concat(t.response.data.result))})},updateSelectedCompany:function(e){this.newProject.companyId=e,this.selectedOPTs=[],this.selectedUSERs=[]},updateSelectedOPTs:function(e){this.newProject.OPT=e},updateSelectedUSERs:function(e){this.newProject.USER=e},getImage:function(e){var t=this;sn(e.raw).then(function(e){t.newProject.sitePlan=e.data.url,t.image="".concat("https://geo-stage.chuen.com.tw:3333/v1","/").concat(t.newProject.sitePlan)})},beforeImgUpload:function(e){var t=e.size/1024/1024<2;return t||this.$message.error("上傳圖片大小不能超過 2MB!"),t},strToNumArrayObject:function(e){var t=this;e.forEach(function(e){t.strToNumObject(e)})},strToNumObject:function(e){for(var t in e)e[t]=+e[t]},getVGItems:function(){var e=this.newProject.floor;this.fullVGsInfo=this.importVGItems(e,this.numOfFloor,this.VGList),this.initVGManagement(),this.getVGTable(0)},currentFloor:function(e){this.floorIndex=e-1,this.getVGTable(this.floorIndex)},updateSelectedVGs:function(e){var t=this;this.fullVGsInfo=[];var n=[];e.forEach(function(e){var s=t.VGs.filter(function(t){return t.id==e});n=n.concat(s)}),this.VGList=n},getVGTable:function(e){var t=e*this.numOfFloor,n=(e+1)*this.numOfFloor;this.vgTable=this.fullVGsInfo.slice(t,n)},initVGManagement:function(){for(var e=[],t=0;t<this.newProject.floor;t++)e.push({notice:0,warning:0,action:0});this.newProject.vgManagement=e},getSOItems:function(){this.newProject.soLocation=this.initSOLocation(this.soQt,this.soDepth)},initSOLocation:function(e,t){for(var n=[],s=1;s<=e;s++)n.push({number:"SO-0".concat(s),depth:t});return n},mergeVGLocation:function(e,t){t.forEach(function(t,n){e[n].number=t.serial,e[n].steelId=t.steelId})},initVGLocation:function(){for(var e=this.newProject.floor*this.numOfFloor,t=[],n=0;n<e;n++)t.push({number:"",steelId:""});this.newProject.vgLocation=t},disableVG:function(e){return e&&"使用的專案被刪除"!==e}}},on=an,rn=(n("5250"),Object(Ie["a"])(on,Dt,Gt,!1,null,"5311e4bb",null)),cn=rn.exports,ln=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ProjectEdit"},[n("h1",[e._v("專案設定")]),n("el-form",{attrs:{"label-position":"top","label-width":"80px",model:e.newProject,rules:e.rules}},[n("h2",[e._v("基本資料")]),n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"專案案號"}},[n("el-input",{attrs:{disabled:""},model:{value:e.newProject.number,callback:function(t){e.$set(e.newProject,"number",t)},expression:"newProject.number"}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"專案狀態"}},[n("el-select",{staticStyle:{width:"100%"},on:{change:e.updateSelectedStatus},model:{value:e.selectedStatus,callback:function(t){e.selectedStatus=t},expression:"selectedStatus"}},e._l(e.statusList,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1),n("el-row",{attrs:{gutter:20}},[n("el-col",[n("el-form-item",{attrs:{label:"專案名稱",required:""}},[n("el-input",{model:{value:e.newProject.name,callback:function(t){e.$set(e.newProject,"name",t)},expression:"newProject.name"}})],1)],1)],1),n("el-form-item",{attrs:{label:"地點"}},[n("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"大武街 34 號"},model:{value:e.newProject.address,callback:function(t){e.$set(e.newProject,"address",t)},expression:"newProject.address"}})],1),n("el-form-item",{attrs:{label:"客戶公司名稱"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"雨宮營造"},on:{change:e.updateSelectedCompany},model:{value:e.selectedCompany,callback:function(t){e.selectedCompany=t},expression:"selectedCompany"}},e._l(e.companiesList,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),n("h2",[e._v("參與人員")]),n("el-tabs",{attrs:{type:"border-card",stretch:""}},[n("el-tab-pane",{attrs:{label:"OPT"}},[n("el-form-item",[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"請選擇 OPT",multiple:""},on:{change:e.updateSelectedOPTs},model:{value:e.selectedOPT,callback:function(t){e.selectedOPT=t},expression:"selectedOPT"}},e._l(e.OPTList,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),n("el-tab-pane",{attrs:{label:"USER"}},[e._v("\n        "+e._s(e.selectedUSER)+"\n        "),n("el-form-item",{attrs:{label:"客戶公司名稱"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"請選擇 USER",multiple:""},on:{change:e.updateSelectedUSERs},model:{value:e.selectedUSER,callback:function(t){e.selectedUSER=t},expression:"selectedUSER"}},e._l(e.USERList,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1)],1),n("h1",[e._v("配置圖")]),n("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:e.uploadURL,"on-change":e.getImage,"list-type":"picture","before-upload":e.beforeImgUpload,"auto-upload":!0}},[e.newProject.sitePlan?n("img",{attrs:{src:e.image}}):e._e(),e.newProject.sitePlan?e._e():n("i",{staticClass:"el-icon-upload"}),e.newProject.sitePlan?e._e():n("div",{staticClass:"el-upload__text"},[e._v("\n        將文件拖到此處，或"),n("em",[e._v("點擊上傳")])]),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("上傳文件不能超過2Mb")]),e.newProject.sitePlan?n("el-button",{staticClass:"reselect",attrs:{size:"small",type:"primary"}},[e._v("另選圖片")]):e._e()],1),n("h2",[e._v("監控設定")]),n("el-tabs",{attrs:{type:"border-card",stretch:""}},[n("el-tab-pane",{attrs:{label:"軸力計 ( VG )"}},[n("el-form-item",{attrs:{label:"使用軸力計編號"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",disabled:""},on:{change:e.updateSelectedVGs},model:{value:e.newProject.vgIds,callback:function(t){e.$set(e.newProject,"vgIds",t)},expression:"newProject.vgIds"}},e._l(e.VGs,function(e){return n("el-option",{key:e.id,attrs:{label:e.number,value:e.id}})}))],1),n("el-form-item",{attrs:{label:"換軸力計"}},[n("el-select",{staticStyle:{width:"100%"},model:{value:e.removedVG,callback:function(t){e.removedVG=t},expression:"removedVG"}},e._l(e.removeVGList,function(e){return n("el-option",{key:e.id,attrs:{label:e.number,value:e.id}})}))],1),n("el-form-item",{attrs:{label:"換成"}},[n("el-select",{staticStyle:{width:"100%"},model:{value:e.addedVG,callback:function(t){e.addedVG=t},expression:"addedVG"}},e._l(e.addedVGList,function(e){return n("el-option",{key:e.id,attrs:{label:e.number,value:e.id}})}))],1),n("el-button",{directives:[{name:"show",rawName:"v-show",value:e.vgVariable,expression:"vgVariable"}],on:{click:function(t){e.switchVG(e.removedVG,e.addedVG)}}},[e._v("確認轉換")]),e.newProject.vgLocation.length?n("div",{staticClass:"block"},[n("span",{staticClass:"demonstration"},[e._v("請選擇支撐階數")]),n("el-pagination",{attrs:{layout:"prev, pager, next",total:e.getPagination},on:{"current-change":e.currentFloor}})],1):e._e(),e.newProject.vgLocation.length?n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{md:6,sm:8,span:24}},[n("h2",[e._v("管理值"),n("span",[e._v("單位：噸")])]),n("el-form-item",{attrs:{label:"注意值",prop:"vgManagement["+this.floorIndex+"].notice",rules:[{required:!0,message:"請檢查注意值",trigger:["blur","change"]},{pattern:/^\d+(\.\d{0,1})?$/,message:"小數點下最多一位 0.1",trigger:["blur","change"]}]}},[n("el-input",{attrs:{size:"mini",placeholder:"68.3"},model:{value:e.newProject.vgManagement[e.floorIndex].notice,callback:function(t){e.$set(e.newProject.vgManagement[e.floorIndex],"notice",t)},expression:"newProject.vgManagement[floorIndex].notice"}})],1),n("el-form-item",{attrs:{label:"警戒值",prop:"vgManagement["+this.floorIndex+"].warning",rules:[{required:!0,message:"請檢查警戒值",trigger:["blur","change"]},{pattern:/^\d+(\.\d{0,1})?$/,message:"小數點下最多一位 0.1",trigger:["blur","change"]}]}},[n("el-input",{attrs:{size:"mini",placeholder:"79.6"},model:{value:e.newProject.vgManagement[e.floorIndex].warning,callback:function(t){e.$set(e.newProject.vgManagement[e.floorIndex],"warning",t)},expression:"newProject.vgManagement[floorIndex].warning"}})],1),n("el-form-item",{attrs:{label:"行動值",prop:"vgManagement["+this.floorIndex+"].action",rules:[{required:!0,message:"請檢查行動值",trigger:["blur","change"]},{pattern:/^\d+(\.\d{0,1})?$/,message:"小數點下最多一位 0.1",trigger:["blur","change"]}]}},[n("el-input",{attrs:{size:"mini",placeholder:"104.2"},model:{value:e.newProject.vgManagement[e.floorIndex].action,callback:function(t){e.$set(e.newProject.vgManagement[e.floorIndex],"action",t)},expression:"newProject.vgManagement[floorIndex].action"}})],1)],1),n("el-col",{attrs:{md:16,sm:16,span:24}},[n("h2",[e._v("位置編碼"),n("span",[e._v("( VG - 層數 - 流水號 )")])]),n("el-button",{staticClass:"maintainSteel",on:{click:e.saveCurrentAndGo}},[e._v("\n              維護鋼材資料\n            ")]),n("el-table",{staticClass:"vg-table",attrs:{data:e.vgTable}},[n("el-table-column",{attrs:{prop:"vgNumber",label:"VG",width:"120"}}),n("el-table-column",{attrs:{prop:"port",label:"Port",width:"100"}}),n("el-table-column",{attrs:{prop:"number",label:"編碼",width:"100"}}),n("el-table-column",{attrs:{prop:"steelId",label:"鋼材",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-select",{attrs:{placeholder:"請選擇鋼材"},model:{value:t.row.steelId,callback:function(n){e.$set(t.row,"steelId",n)},expression:"scope.row.steelId"}},e._l(e.Steels,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))]}}])})],1)],1)],1):e._e()],1),n("el-tab-pane",{attrs:{label:"傾度管 ( SO )"}},[e.newProject.soLocation.length?n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:8}},[n("h2",[e._v("管理值"),n("span",[e._v("單位：cm")])]),n("el-form-item",{attrs:{label:"注意值",prop:"soManagement.notice"}},[n("el-input",{attrs:{size:"mini",placeholder:"1.68"},model:{value:e.newProject.soManagement.notice,callback:function(t){e.$set(e.newProject.soManagement,"notice",t)},expression:"newProject.soManagement.notice"}})],1),n("el-form-item",{attrs:{label:"警戒值",prop:"soManagement.warning"}},[n("el-input",{attrs:{size:"mini",placeholder:"2.88"},model:{value:e.newProject.soManagement.warning,callback:function(t){e.$set(e.newProject.soManagement,"warning",t)},expression:"newProject.soManagement.warning"}})],1),n("el-form-item",{attrs:{label:"行動值",prop:"soManagement.action"}},[n("el-input",{attrs:{size:"mini",placeholder:"3.77"},model:{value:e.newProject.soManagement.action,callback:function(t){e.$set(e.newProject.soManagement,"action",t)},expression:"newProject.soManagement.action"}})],1)],1),n("el-col",{attrs:{span:14}},[n("h2",[e._v("位置編號"),n("span",[e._v("( SO - 流水號 )")])]),n("h5",[e._v("相同位置編碼 量測深度間隔 1 m")]),n("el-table",{staticClass:"so-table",attrs:{data:e.newProject.soLocation}},[n("el-table-column",{attrs:{prop:"number",label:"編碼",width:"200"}}),n("el-table-column",{attrs:{prop:"depth",label:"深度",width:"200"}})],1)],1)],1):e._e()],1)],1),n("br"),n("el-form-item",[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:12}},[n("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.edit}},[e._v("\n            確定送出\n          ")])],1),n("el-col",{attrs:{span:12}},[n("el-button",{staticStyle:{width:"100%"},on:{click:e.cancel}},[e._v("\n            取消\n          ")])],1)],1)],1)],1)],1)},un=[],dn={name:"ProjectEdit",mixins:[we,Vt],created:function(){this.image="".concat("https://geo-stage.chuen.com.tw:3333/v1","/").concat(this.newProject.sitePlan)},data:function(){return{removedVG:"",addedVG:"",floorIndex:0,VGList:[],vgTable:[],image:"",OPTList:[],USERList:[],selectedOPT:[],selectedUSER:[],selectedCompany:"",selectedStatus:"",statusList:[{value:"end",label:"結案"},{value:"in-progress",label:"執行"}],VGItems:[],rules:{"soManagement.notice":[{required:!0,message:"請輸入注意值",trigger:["blur","change"]},{pattern:/^\d+(\.\d{0,2})?$/,message:"小數點下最多兩位 0.01",trigger:["blur","change"]}],"soManagement.warning":[{required:!0,message:"請輸入警戒值",trigger:["blur","change"]},{pattern:/^\d+(\.\d{0,2})?$/,message:"小數點下最多兩位 0.01",trigger:["blur","change"]}],"soManagement.action":[{required:!0,message:"請輸入行動值",trigger:["blur","change"]},{pattern:/^\d+(\.\d{0,2})?$/,message:"小數點下最多兩位 0.01",trigger:["blur","change"]}]}}},watch:{selectedCompany:function(e){var t=this,n=this.$store.getters.OPTs,s=n.filter(function(t){return t.company.id==e}),a=n.filter(function(e){return e.company.id==t.myCompany.id});this.OPTList=a.concat(s);var o=this.$store.getters.USERs,r=o.filter(function(t){return t.company.id==e});this.USERList=r}},computed:{project:function(){return this.$store.getters.currentProject},companiesList:function(){var e=this,t=this.$store.getters.companies;return t.filter(function(t){return t.id!=e.myCompany.id})},myCompany:function(){return this.$store.getters.me.company},uploadURL:function(){return"".concat("https://geo-stage.chuen.com.tw:3333/v1","/uploads")},VGs:function(){return this.$store.getters.vgs},removeVGList:function(){var e=this,t=[];return this.newProject.vgIds.forEach(function(n){var s=e.VGs.filter(function(e){return e.id===n});t=t.concat(s)}),t},addedVGList:function(){var e=this;return this.VGs.filter(function(t){return!e.removeVGList.includes(t)})},vgVariable:function(){return!!this.removedVG&&!!this.addedVG},getPagination:function(){return 10*this.newProject.floor},Steels:function(){return this.$store.getters.steels},numOfFloor:function(){return this.project.vgLocation.length/this.project.floor},fullVGsInfo:function(){return this.project.vgLocation},newProject:function(){return this.getVGTable(0),this.setSelectedBox(),{number:this.project.number,status:this.project.status,name:this.project.name,address:this.project.address,companyId:this.project.companyId,sitePlan:this.project.sitePlan,OPT:this.project.OPT,USER:this.project.USER,floor:this.project.floor,vgManagement:this.project.vgManagement,soManagement:this.project.soManagement,vgIds:this.project.vgIds,vgLocation:this.project.vgLocation,soLocation:this.project.soLocation}}},methods:{cancel:function(){this.toPath("ProjectSetting")},edit:function(){var e=this;delete this.newProject.floor,this.newProject.vgLocation.map(function(e){delete e.vgId,delete e.vgNumber,delete e.steelName}),this.strToNumArrayObject(this.newProject.vgManagement),this.strToNumObject(this.newProject.soManagement),this.newProject.OPT=this.selectedOPT,this.newProject.USER=this.selectedUSER,this.$store.dispatch("updateProject",{projectId:this.$route.params.projectId,payload:this.newProject}).then(function(){e.$message({message:"成功編輯 ".concat(e.newProject.name),type:"success",center:!0,duration:1800}),e.toPath("ProjectSetting")}).catch(function(t){e.$message.error("請重新檢查 ".concat(t.response.data.result))})},strToNumArrayObject:function(e){var t=this;e.forEach(function(e){t.strToNumObject(e)})},strToNumObject:function(e){for(var t in e)e[t]=+e[t]},updateSelectedStatus:function(e){this.newProject.status=e},updateSelectedOPTs:function(e){this.newProject.OPT=e},updateSelectedUSERs:function(e){this.newProject.USER=e},updateSelectedCompany:function(e){this.newProject.companyId=e,this.selectedUSER=[],this.selectedOPT=[]},updateSelectedVGs:function(e){var t=this,n=[];e.forEach(function(e){var s=t.VGs.filter(function(t){return t.id==e});n=n.concat(s)}),this.VGList=n},getImage:function(e){var t=this;this.$store.dispatch("uploadConfigImage",e.raw).then(function(){t.image="".concat("https://geo-stage.chuen.com.tw:3333/v1","/").concat(t.newProject.sitePlan)})},beforeImgUpload:function(e){var t=e.size/1024/1024<2;return t||this.$message.error("上傳圖片大小不能超過 2MB!"),t},switchVG:function(e,t){var n=this.newProject.vgIds.indexOf(e);this.newProject.vgIds.splice(n,1,t),this.removedVG="",this.addedVG=""},currentFloor:function(e){this.floorIndex=e-1,this.getVGTable(this.floorIndex)},getVGTable:function(e){var t=e*this.numOfFloor,n=(e+1)*this.numOfFloor;this.vgTable=this.fullVGsInfo.slice(t,n)},saveCurrentAndGo:function(){this.$store.dispatch("updateCurrentProject",this.newProject),this.toPath("SteelList")},setSelectedBox:function(){this.selectedOPT=this.project.OPT.map(function(e){return e.id}),this.selectedUSER=this.project.USER.map(function(e){return e.id}),this.selectedCompany=this.project.companyId,this.selectedStatus=this.project.status}}},mn=dn,pn=(n("1e37"),Object(Ie["a"])(mn,ln,un,!1,null,null,null)),hn=pn.exports,fn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"projectMonitor"},[n("h1",[e._v("查看監控資料")]),n("h3",[e._v("基本資料")]),n("p",[e._v("案號："+e._s(e.project.number))]),n("p",[e._v("名稱："+e._s(e.project.name))]),n("h3",{staticClass:"inline"},[e._v("配置圖")]),n("h4",{staticClass:"inline show-picture clickable",on:{click:function(t){e.show=!e.show}}},[e._v("\n    顯示/隱藏\n  ")]),e.show?n("img",{attrs:{src:e.showImage}}):e._e(),n("h3",[e._v("監控值")]),n("el-tabs",{attrs:{type:"border-card",stretch:""}},[n("el-tab-pane",{attrs:{label:"軸力計 ( VG )"}},[n("el-form",{attrs:{"label-position":"top"}},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{xs:24,sm:14,md:14}},[n("el-form-item",{attrs:{label:"日期"}},[n("el-date-picker",{attrs:{format:"yyyy-MM-dd",type:"date","picker-options":e.disabledDate},model:{value:e.vgDate,callback:function(t){e.vgDate=t},expression:"vgDate"}})],1)],1),n("el-col",{attrs:{xs:24,sm:10,md:10}},[n("el-form-item",{attrs:{label:"支撐階數"}},[n("el-select",{attrs:{placeholder:"請選擇"},model:{value:e.selectedFloor,callback:function(t){e.selectedFloor=t},expression:"selectedFloor"}},e._l(e.floorList,function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})}))],1)],1)],1)],1),n("VGECharts",{attrs:{selectedDay:e.vgDate,selectedFloor:e.selectedFloor,vgChartData:e.vgChartData,project:e.project}}),e.isShow("project:export")?n("el-button",{on:{click:e.exportVG}},[e._v("匯出資料")]):e._e()],1),n("el-tab-pane",{attrs:{label:"傾度管 ( SO )"}},[n("el-form",{attrs:{"label-position":"top"}},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{xs:24,sm:10,md:10}},[n("el-form-item",{attrs:{label:"位置"}},[n("el-select",{attrs:{placeholder:"請選擇位置"},model:{value:e.selectedSO,callback:function(t){e.selectedSO=t},expression:"selectedSO"}},e._l(e.project.soLocation,function(e){return n("el-option",{key:e.number,attrs:{label:e.number,value:e.number}})}))],1)],1),n("el-col",{attrs:{xs:24,sm:14,md:14}},[n("el-form-item",{attrs:{label:"日期"}},[n("el-select",{attrs:{placeholder:"請選擇日期"},model:{value:e.soDate,callback:function(t){e.soDate=t},expression:"soDate"}},e._l(e.soDateList,function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})}))],1)],1)],1)],1),e.selectedSO&&e.soDate?n("SOECharts",{attrs:{soChartData:e.soChartData,project:e.project}}):e._e(),e.isShow("project:export")?n("el-button",{on:{click:e.exportSO}},[e._v("匯出資料")]):e._e()],1)],1),n("br")],1)},gn=[],bn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vgECharts"},[n("chart",{ref:"chart1",attrs:{options:e.options,"auto-resize":!0}})],1)},vn=[],wn=(n("c5f6"),n("c1df")),jn=n.n(wn),yn={name:"VGECharts",props:{vgChartData:Array,project:Object,selectedDay:Date,selectedFloor:Number},computed:{vgsPosition:function(){return this.vgChartData.map(function(e){return e.vgLocation})},vgManagement:function(){return this.project.vgManagement[this.selectedFloor-1]},markLine:function(){return{silent:!0,data:[{label:{formatter:"行動值",position:"start"},lineStyle:{color:"red"},yAxis:-this.vgManagement.action},{label:{formatter:"警戒值",position:"start"},lineStyle:{color:"blue"},yAxis:-this.vgManagement.warning},{label:{formatter:"管理值",position:"start"},lineStyle:{color:"green"},yAxis:-this.vgManagement.notice},{label:{formatter:"管理值",position:"start"},lineStyle:{color:"green"},yAxis:this.vgManagement.notice},{label:{formatter:"警戒值",position:"start"},lineStyle:{color:"blue"},yAxis:this.vgManagement.warning},{label:{formatter:"行動值",position:"start"},lineStyle:{color:"red"},yAxis:this.vgManagement.action}]}},seriesData:function(){var e=this;return this.vgChartData.length?this.vgChartData.map(function(t){return{name:t.vgLocation,type:"line",data:t.data,markLine:e.markLine}}):{type:"line",markLine:this.markLine}},options:function(){return{tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{data:this.vgsPosition},xAxis:{type:"time",min:+jn()(this.selectedDay).startOf("day"),max:+jn()(this.selectedDay).endOf("day"),axisLabel:{formatter:function(e){return jn()(e).format("HH:mm")}}},yAxis:{max:1.2*this.vgManagement.action,min:1.2*-this.vgManagement.action,type:"value"},series:this.seriesData}}}},Pn=yn,Sn=Object(Ie["a"])(Pn,bn,vn,!1,null,null,null),_n=Sn.exports,In=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"soECharts"},[n("chart",{ref:"chart1",attrs:{options:e.options,"auto-resize":!0}})],1)},kn=[],Cn=(n("8615"),n("456d"),{name:"SOECharts",props:{soChartData:Array,project:Object},data:function(){return{}},computed:{soManagement:function(){return this.project.soManagement},markLine:function(){return{silent:!0,data:[{lineStyle:{color:"green"},name:"管理值",xAxis:this.soManagement.notice,label:{normal:{formatter:"管理值"}}},{lineStyle:{color:"green"},name:"管理值",xAxis:-this.soManagement.notice,label:{normal:{formatter:"管理值"}}},{lineStyle:{color:"blue"},name:"警戒值",xAxis:this.soManagement.warning,label:{normal:{formatter:"警戒值"}}},{lineStyle:{color:"blue"},name:"警戒值",xAxis:-this.soManagement.warning,label:{normal:{formatter:"警戒值"}}},{lineStyle:{color:"red"},name:"行動值",xAxis:this.soManagement.action,label:{normal:{formatter:"行動值"}}},{lineStyle:{color:"red"},name:"行動值",xAxis:-this.soManagement.action,label:{normal:{formatter:"行動值"}}}]}},soLegend:function(){var e=Object.keys(this.soChartData[0]);return e.shift(),e},soData:function(){var e=new Array(3).fill(0);e[0]=this.soChartData[0].depth-1;var t=[];return t.push(e),this.soChartData.forEach(function(e){return t.push(Object.values(e))}),t.map(function(e){return e[0]+=1}),t.unshift(Object.keys(this.soChartData[0])),t},seriesData:function(){var e=this;return this.soLegend.map(function(t){return{name:t,type:"line",encode:{x:t,y:"depth"},markLine:e.markLine,smooth:!0}})},options:function(){return{tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{data:this.soLegend},dataset:{source:this.soData},xAxis:{type:"value",max:2*this.soManagement.action,min:2*-this.soManagement.action},yAxis:{type:"value"},series:this.seriesData}}}}),xn=Cn,On=Object(Ie["a"])(xn,In,kn,!1,null,null,null),Mn=On.exports,Ln=n("21a6"),$n={name:"ProjectMonitor",components:{VGECharts:_n,SOECharts:Mn},mixins:[we],created:function(){this.getVGData(this.lastDate,1)},mounted:function(){this.vgDate=this.lastDate},data:function(){return{vgDate:this.lastDate,soDate:"",selectedFloor:1,selectedSO:"",floorIndex:0,show:!0}},computed:{showImage:function(){if(this.project.sitePlan)return"".concat("https://geo-stage.chuen.com.tw:3333/v1","/").concat(this.project.sitePlan)},project:function(){return this.$store.getters.currentProject},startDate:function(){return jn()(this.project.dataRangeVg.start).toDate()},lastDate:function(){return jn()(this.project.dataRangeVg.end).toDate()},floorList:function(){return Array.from(Array(this.project.floor).keys()).map(function(e){return e+1})},disabledDate:function(){var e=jn()(this.startDate).subtract(1,"d").toDate(),t=jn()(this.lastDate).toDate();return{disabledDate:function(n){return n.getTime()<e||n.getTime()>t}}},vgChartData:function(){return this.$store.getters.vgMeasuredData},soDateList:function(){return this.$store.getters.dateOfSoMeasuredData},soChartData:function(){var e=this,t=this.$store.getters.soMeasuredData.filter(function(t){return t.date===e.soDate}).shift();return t&&t.soData}},watch:{selectedFloor:function(e){this.getVGData(this.vgDate,e)},vgDate:function(e){this.getVGData(e,this.selectedFloor)},selectedSO:function(e){this.soDate="",this.getSOData(e)}},methods:{isShow:function(e){return this.$store.getters.myPermissions.includes(e)},getVGData:function(e,t){var n={projectId:this.$route.params.projectId,date:jn()(e).format("YYYY/MM/DD"),floor:t};this.$store.dispatch("fetchVgMeasuredData",n)},getSOData:function(e){if(e){var t={projectId:this.$route.params.projectId,locationNumber:e};this.$store.dispatch("fetchSoMeasuredData",t)}},exportVG:function(){var e=this,t=this.$route.params.projectId,n=jn()().format("MMDD hhmm"),s=this.$store.getters.token;this.$message({message:"正在下載'".concat(this.project.name,"'的軸力計資料"),type:"info",center:!0,duration:1800}),fetch("https://geo-stage.chuen.com.tw:3333/v1/measures/vg/export?projectId=".concat(t),{headers:{"x-access-token":s}}).then(function(e){return e.blob()}).then(function(t){Object(Ln["saveAs"])(t,"".concat(e.project.name,"-").concat(n,".xlsx"))}).then(function(){e.$message({message:"成功下載 ".concat(e.project.name),type:"success",center:!0,duration:1800})})},exportSO:function(){var e=this,t=this.$route.params.projectId,n=jn()().format("MMDD hhmm"),s=this.$store.getters.token;this.$message({message:"正在下載'".concat(this.project.name,"'的傾度管資料"),type:"info",center:!0,duration:1800}),fetch("https://geo-stage.chuen.com.tw:3333/v1/measures/so/export?projectId=".concat(t),{headers:{"x-access-token":s}}).then(function(e){return e.blob()}).then(function(t){Object(Ln["saveAs"])(t,"傾度管".concat(e.project.name,"-").concat(n,".xlsx"))}).then(function(){e.$message({message:"成功下載 ".concat(e.project.name),type:"success",center:!0,duration:1800})})}}},Dn=$n,Gn=(n("27b1"),Object(Ie["a"])(Dn,fn,gn,!1,null,"85dd9a3a",null)),En=Gn.exports,Vn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"projectPhaseList"},[n("h1",[e._v("專案執行階段")]),n("el-row",{staticClass:"operationGroup",attrs:{type:"flex",justify:"between"}},[n("el-col",{staticClass:"operationGroup-left",attrs:{sm:4}},[e.deleteList.length?n("el-button",{attrs:{type:"primary"},on:{click:e.deleteProjectPhases}},[e._v("刪除")]):e._e()],1),n("el-col",{staticClass:"operationGroup-right",attrs:{span:24,sm:8}},[n("el-input",{attrs:{placeholder:"新增專案階段"},model:{value:e.newProjectPhase.name,callback:function(t){e.$set(e.newProjectPhase,"name",t)},expression:"newProjectPhase.name"}}),e.newProjectPhase.name?n("el-button",{staticClass:"addButton",attrs:{type:"primary"},on:{click:e.createProjectPhase}},[n("i",{staticClass:"el-icon-plus"})]):e._e()],1)],1),n("el-table",{staticClass:"projectPhaseList-table",attrs:{data:e.projectPhaseList},on:{"selection-change":e.updateDeleteList}},[n("el-table-column",{attrs:{type:"selection",width:"40"}}),n("el-table-column",{attrs:{prop:"name",label:"專案階段"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{on:{blur:function(n){e.editProjectPhase(t.row.id,t.row.name)}},model:{value:t.row.name,callback:function(n){e.$set(t.row,"name",n)},expression:"scope.row.name"}})]}}])})],1)],1)},Un=[],Rn={name:"projectPhaseList",mixins:[we],data:function(){return{deleteList:[],newProjectPhase:{name:""}}},computed:{projectPhaseList:function(){return JSON.parse(JSON.stringify(this.$store.getters.projectPhases))}},methods:{createProjectPhase:function(){var e=this;this.$store.dispatch("createProjectPhase",this.newProjectPhase).then(function(){e.reset()})},reset:function(){var e=this;this.$store.dispatch("getProjectPhases").then(function(){e.newProjectPhase={number:""}})},deleteProjectPhases:function(){var e=this;0!==this.deleteList.length&&this.$store.dispatch("deleteProjectPhases",this.deleteList).then(function(){e.$message({message:"成功刪除 ".concat(e.deleteList),type:"success",center:!0,duration:1800})}).catch(function(t){e.$message.error("請重新檢查 ".concat(t.response.data.result))})},updateDeleteList:function(e){this.deleteList=e.map(function(e){return e.id})},editProjectPhase:function(e,t){var n=this;t!==this.$store.getters.projectPhases.filter(function(t){return t.id==e})[0].name&&this.$store.dispatch("updateProjectPhase",{projectPhaseId:e,payload:{name:t}}).then(function(){n.$message({message:"成功編輯 ".concat(n.newProject.name),type:"success",center:!0,duration:1800})}).catch(function(e){n.$message.error("請重新檢查 ".concat(e.response.data.result))})}}},Tn=Rn,An=Object(Ie["a"])(Tn,Vn,Un,!1,null,null,null),Nn=An.exports,qn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vgList"},[n("h1",[e._v("軸力計")]),n("el-row",{staticClass:"operationGroup",attrs:{type:"flex",justify:"between"}},[n("el-col",{staticClass:"operationGroup-left",attrs:{sm:4}},[e.deleteList.length?n("el-button",{attrs:{type:"primary"},on:{click:e.deleteVGs}},[e._v("刪除")]):e._e()],1),n("el-col",{staticClass:"operationGroup-right",attrs:{span:24,sm:8}},[n("el-input",{attrs:{placeholder:"新增軸力計"},model:{value:e.newVG.number,callback:function(t){e.$set(e.newVG,"number",t)},expression:"newVG.number"}}),e.newVG.number?n("el-button",{staticClass:"addButton",attrs:{type:"primary"},on:{click:e.createVG}},[n("i",{staticClass:"el-icon-plus"})]):e._e()],1)],1),n("el-table",{staticClass:"vgList-table",attrs:{data:e.vgList},on:{"selection-change":e.updateDeleteList}},[n("el-table-column",{attrs:{type:"selection",selectable:e.checkable,width:"40"}}),n("el-table-column",{attrs:{prop:"number",label:"編號",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{on:{blur:function(n){e.editVG(t.row.id,t.row.number)}},model:{value:t.row.number,callback:function(n){e.$set(t.row,"number",n)},expression:"scope.row.number"}})]}}])}),n("el-table-column",{attrs:{prop:"projectName",label:"所在專案"}})],1)],1)},zn=[],Fn={number:"VGList",mixins:[we],data:function(){return{deleteList:[],newVG:{number:""}}},computed:{vgList:function(){return JSON.parse(JSON.stringify(this.$store.getters.vgs))}},methods:{reset:function(){var e=this;this.$store.dispatch("getVGs").then(function(){e.newVG={number:""}})},createVG:function(){var e=this;this.newVG.number||alert("Enter the vg's name PLZ"),this.$store.dispatch("createVG",this.newVG).then(function(){e.reset(),e.$message({message:"成功新增 ".concat(e.newVG.number),type:"success",center:!0,duration:1800})}).catch(function(t){e.$message.error("請重新檢查 ".concat(t.response.data.result))})},deleteVGs:function(){var e=this;0!==this.deleteList.length&&this.$store.dispatch("deleteVGs",this.deleteList).then(function(){e.$message({message:"軸力計 ".concat(e.deleteList," 已刪除"),type:"success",showClose:!0,center:!0,duration:1200})}).catch(function(){e.$message({message:"已被專案使用",type:"error",showClose:!0,center:!0,duration:1200})})},updateDeleteList:function(e){this.deleteList=e.map(function(e){return e.id})},checkable:function(e){return!e.projectName},editVG:function(e,t){var n=this;t!==this.$store.getters.vgs.filter(function(t){return t.id==e})[0].number&&this.$store.dispatch("updateVG",{vgId:e,payload:{number:t}}).then(function(){n.reset(),n.$message({message:"成功編輯 ".concat(t),type:"success",center:!0,duration:1800})}).catch(function(e){n.$message.error("請重新檢查 ".concat(e.response.data.result))})}}},Bn=Fn,Jn=(n("c322"),Object(Ie["a"])(Bn,qn,zn,!1,null,null,null)),Qn=Jn.exports,Hn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"steelList"},[n("h1",[e._v("鋼材資料")]),n("el-form",{attrs:{"label-position":"top","label-width":"80px",model:e.newSteel,rules:e.rules}},[n("h3",[e._v("新增鋼材")]),n("el-form-item",{attrs:{label:"型號",prop:"name"}},[n("el-input",{attrs:{disabled:!e.isShow},model:{value:e.newSteel.name,callback:function(t){e.$set(e.newSteel,"name",t)},expression:"newSteel.name"}})],1),n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"ES ( kg/cm^2 )",prop:"es"}},[n("el-input",{attrs:{disabled:!e.isShow},model:{value:e.newSteel.es,callback:function(t){e.$set(e.newSteel,"es",e._n(t))},expression:"newSteel.es"}})],1)],1),n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"TCM",prop:"tcm"}},[n("el-input",{attrs:{disabled:!e.isShow},model:{value:e.newSteel.tcm,callback:function(t){e.$set(e.newSteel,"tcm",e._n(t))},expression:"newSteel.tcm"}})],1)],1),n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"TCG",prop:"tcg"}},[n("el-input",{attrs:{disabled:!e.isShow},model:{value:e.newSteel.tcg,callback:function(t){e.$set(e.newSteel,"tcg",e._n(t))},expression:"newSteel.tcg"}})],1)],1),n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"截面積 ( cm^2 )",prop:"sectionArea"}},[n("el-input",{attrs:{disabled:!e.isShow},model:{value:e.newSteel.sectionArea,callback:function(t){e.$set(e.newSteel,"sectionArea",e._n(t))},expression:"newSteel.sectionArea"}})],1)],1)],1),e.isEdit?e._e():n("el-button",{attrs:{type:"primary",disabled:e.passRequired},on:{click:e.createSteel}},[e._v("\n      新增鋼材\n    ")]),e.isEdit?n("el-button",{attrs:{type:"primary",disabled:e.passRequired},on:{click:e.editSteel}},[e._v("\n      編輯鋼材\n    ")]):e._e()],1),n("h3",[e._v("鋼材列表")]),n("div",{staticClass:"operationGroup"},[n("div",{staticClass:"operationGroup-left"},[n("el-button",{on:{click:e.addSteel}},[e._v("新增")])],1),n("div",{staticClass:"operationGroup-right"},[n("el-button",{directives:[{name:"show",rawName:"v-show",value:e.deletable,expression:"deletable"}],attrs:{type:"primary"},on:{click:e.deleteSteels}},[e._v("刪除")])],1)]),n("el-table",{staticClass:"steelList-table",attrs:{data:e.steelList,"highlight-current-row":e.isEdit},on:{"selection-change":e.updateDeleteList}},[n("el-table-column",{attrs:{type:"selection",selectable:e.checkable,width:"40"}}),n("el-table-column",{attrs:{prop:"name",label:"鋼材名稱",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("h4",{staticClass:"clickable",on:{click:function(n){e.loadSteel(t.row)}}},[e._v("\n          "+e._s(t.row.name)+"\n        ")])]}}])}),n("el-table-column",{attrs:{prop:"sectionArea",label:"截面積 (cm^2)",width:"120"}}),n("el-table-column",{attrs:{prop:"es",label:"ES (kg/cm^2)",width:"120"}}),n("el-table-column",{attrs:{prop:"tcm",label:"TCM",width:"100"}}),n("el-table-column",{attrs:{prop:"tcg",label:"TCG",width:"100"}})],1)],1)},Yn=[],Xn={number:"SteelList",mixins:[we],data:function(){return{deleteList:[],choosedId:"",newSteel:{name:"",sectionArea:"",es:"",tcm:"",tcg:""},rules:{name:[{required:!0,message:"請輸入鋼材名稱",trigger:"blur"}],tcg:[{required:!0,message:"請輸入 TCG",trigger:"blur"}],tcm:[{required:!0,message:"請輸入 TCM",trigger:"blur"}],es:[{required:!0,message:"請輸入 ES",trigger:"blur"}],sectionArea:[{required:!0,message:"請輸入截面積",trigger:"blur"}]},isEdit:!1,isShow:!1}},computed:{steelList:function(){return this.$store.getters.steels},deletable:function(){return 0!=this.deleteList.length},passRequired:function(){var e=this.newSteel.name,t=this.newSteel.sectionArea,n=this.newSteel.es,s=this.newSteel.tcm,a=this.newSteel.tcg;return!(e&&t&&n&&s&&a)}},methods:{resetInput:function(){this.choosedId="",this.newSteel={name:"",sectionArea:"",es:"",tcm:"",tcg:""}},addSteel:function(){this.resetInput(),this.isEdit=!1,this.isShow=!0},createSteel:function(){var e=this;this.$store.dispatch("createSteel",this.newSteel).then(function(){e.resetTable()}).catch(function(t){e.$message.error("請重新檢查 ".concat(t.response.data.result))})},deleteSteels:function(){var e=this;0!==this.deleteList.length&&this.$store.dispatch("deleteSteels",this.deleteList).then(function(){e.$message({message:"成功刪除 ".concat(e.deleteList),type:"success",center:!0,duration:1800}),e.resetTable()}).catch(function(t){e.$message.error("請重新檢查 ".concat(t.response.data.result))})},updateDeleteList:function(e){this.isEdit=!0,this.deleteList=e.map(function(e){return e.id})},checkable:function(e){return!e.projectName},editSteel:function(){var e=this;this.$store.dispatch("updateSteel",{steelId:this.choosedId,payload:this.newSteel}).then(function(){e.$message({message:"成功編輯 ".concat(e.newSteel.name),type:"success",center:!0,duration:1800}),e.resetTable()}).catch(function(t){e.$message.error("請重新檢查 ".concat(t.response.data.result))})},loadSteel:function(e){this.isEdit=!0,this.isShow=!0,this.choosedId=e.id,this.newSteel={name:e.name,sectionArea:e.sectionArea,es:e.es,tcm:e.tcm,tcg:e.tcg}},resetTable:function(){var e=this;this.$store.dispatch("getSteels").then(function(){e.isEdit=!1,e.resetInput(),e.isShow=!1})}}},Wn=Xn,Zn=Object(Ie["a"])(Wn,Hn,Yn,!1,null,null,null),Kn=Zn.exports,es=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"soList"},[n("h1",[e._v("傾度管列表")]),n("div",{staticClass:"operationGroup"},[n("div",{staticClass:"operationGroup-left"},[e.deleteList.length?n("el-button",{attrs:{type:"primary"},on:{click:e.deleteSOItems}},[e._v("刪除")]):e._e()],1),n("div",{staticClass:"operationGroup-right"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.toPath("SOItemCreate")}}},[n("i",{staticClass:"el-icon-plus"})])],1)]),n("el-table",{staticClass:"soItems-table",attrs:{data:e.soItems},on:{"selection-change":e.updateDeleteList}},[n("el-table-column",{attrs:{type:"selection",width:"40"}}),n("el-table-column",{attrs:{label:"編號",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("h4",{staticClass:"clickable",on:{click:function(n){e.toPath("SOItemEdit",{soId:t.row.id})}}},[e._v("\n          "+e._s(t.row.number)+"\n        ")])]}}])}),n("el-table-column",{attrs:{prop:"soModelName",label:"廠牌 型號",width:"120"}}),n("el-table-column",{attrs:{prop:"OPT",label:"OPT"}})],1)],1)},ts=[],ns={name:"soItems",mixins:[we],data:function(){return{deleteList:[]}},computed:{soItems:function(){return this.$store.getters.soItems}},methods:{deleteSOItems:function(){var e=this;0!==this.deleteList.length&&this.$store.dispatch("deleteSOItems",this.deleteList).then(function(){e.$message({message:"傾度管 ".concat(e.deleteList," 已刪除"),type:"success",showClose:!0,center:!0,duration:1200})}).catch(function(){e.$message({message:"已選定 OPT 不能刪除",type:"error"})})},updateDeleteList:function(e){this.deleteList=e.map(function(e){return e.id})}}},ss=ns,as=Object(Ie["a"])(ss,es,ts,!1,null,null,null),os=as.exports,rs=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-info"},[n("el-form",[n("section",[n("h1",[e._v("傾度管設備 配置")]),n("h2",[e._v("基本資料")]),n("el-form-item",{attrs:{label:"編號",required:""}},[n("el-input",{attrs:{placeholder:"請輸入編號"},model:{value:e.newSO.number,callback:function(t){e.$set(e.newSO,"number",t)},expression:"newSO.number"}})],1),n("el-form-item",{attrs:{label:"廠牌型號",required:""}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"請選擇"},on:{change:e.initSOModelParameters},model:{value:e.newSO.soModelId,callback:function(t){e.$set(e.newSO,"soModelId",t)},expression:"newSO.soModelId"}},e._l(e.soModels,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),e.newSO.soModelId?[n("h1",[e._v("傾度管 參數")]),n("section",[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.soModelParameters}},[n("el-table-column",{attrs:{prop:"key",label:"參數名稱",width:"180"}}),n("el-table-column",{attrs:{prop:"value",label:"參數值"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{on:{blur:function(n){e.editSO(t.row.key,t.row.value)}},model:{value:t.row.value,callback:function(n){e.$set(t.row,"value",e._n(n))},expression:"scope.row.value"}})]}}])})],1),n("div",{staticClass:"button-container"},[n("el-button",{attrs:{type:"primary"},on:{click:e.resetSOModels}},[e._v("\n            清除參數值\n          ")])],1)],1),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.soModelMeasurable}},[n("el-table-column",{attrs:{prop:"name",label:"欄位名稱",width:"180"}})],1),n("div",{staticClass:"button-container"},[n("el-button",{attrs:{type:"warning"},on:{click:e.cancel}},[e._v("\n          取消\n        ")]),n("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("\n          確定送出\n        ")])],1)]:e._e()],2)],1)},is=[],cs={name:"SOItemCreate",mixins:[we],data:function(){return{newSO:{number:"",soModelId:"",parameters:{c9:0,c8:0,c7:0,c6:0,c5:0,c4:0,c3:0,c2:0,c1:0,c0:0,length:0}},soModelParameters:[]}},computed:{soModels:function(){return this.$store.getters.soModels},soModel:function(){var e=this;return this.soModels.filter(function(t){return t.id==e.newSO.soModelId})[0]},soModelMeasurable:function(){var e=this.soModel.measurable,t=[];return e.forEach(function(e){t.push({name:e})}),t}},methods:{initNewSO:function(){this.newSO={parameters:{C9:0,C8:0,C7:0,C6:0,C5:0,C4:0,C3:0,C2:0,C1:0,C0:0,length:0}}},resetSOModels:function(){this.soModelParameters=[{key:"C9",value:0},{key:"C8",value:0},{key:"C7",value:0},{key:"C6",value:0},{key:"C5",value:0},{key:"C4",value:0},{key:"C3",value:0},{key:"C2",value:0},{key:"C1",value:0},{key:"C0",value:0},{key:"length ( m )",value:0}],this.newSO.parameters={C9:0,C8:0,C7:0,C6:0,C5:0,C4:0,C3:0,C2:0,C1:0,C0:0,length:0}},initSOModelParameters:function(){var e=this.soModel.parameters||{};for(var t in this.newSO.parameters=e,e)this.soModelParameters.push({key:t,value:e[t]})},editSO:function(e,t){this.newSO.parameters[e]=t},cancel:function(){this.toPath("SOItemList")},submit:function(){var e=this;this.$store.dispatch("createSOItem",this.newSO).then(function(){e.$message({message:"成功新增 ".concat(e.newSO.number),type:"success",center:!0,duration:1800}),e.toPath("SOItemList")}).catch(function(t){e.$message.error("請重新檢查 ".concat(t.response.data.result))})}}},ls=cs,us=Object(Ie["a"])(ls,rs,is,!1,null,null,null),ds=us.exports,ms=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-info"},[n("el-form",[n("section",[n("h1",[e._v("傾度管設備 配置")]),n("h2",[e._v("基本資料")]),n("el-form-item",{attrs:{label:"編號",required:""}},[n("el-input",{attrs:{placeholder:"請輸入編號"},model:{value:e.newSOItem.number,callback:function(t){e.$set(e.newSOItem,"number",t)},expression:"newSOItem.number"}})],1),n("el-form-item",{attrs:{label:"廠牌型號",required:""}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"請選擇"},on:{change:e.initSOModelParameters},model:{value:e.newSOItem.soModelId,callback:function(t){e.$set(e.newSOItem,"soModelId",t)},expression:"newSOItem.soModelId"}},e._l(e.soModels,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),e.newSOItem.soModelId?[n("h1",[e._v("傾度管 參數")]),n("section",[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.soModelParameters}},[n("el-table-column",{attrs:{prop:"key",label:"參數名稱",width:"180"}}),n("el-table-column",{attrs:{prop:"value",label:"參數值"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{on:{blur:function(n){e.editSO(t.row.key,t.row.value)}},model:{value:t.row.value,callback:function(n){e.$set(t.row,"value",e._n(n))},expression:"scope.row.value"}})]}}])})],1),n("div",{staticClass:"button-container"},[n("el-button",{attrs:{type:"primary"},on:{click:e.resetSOModels}},[e._v("\n            清除參數值\n          ")])],1)],1),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.soModelMeasurable}},[n("el-table-column",{attrs:{prop:"name",label:"欄位名稱",width:"180"}})],1),n("div",{staticClass:"button-container"},[n("el-button",{attrs:{type:"warning"},on:{click:e.cancel}},[e._v("\n          取消\n        ")]),n("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("\n          確定送出\n        ")])],1)]:e._e()],2)],1)},ps=[],hs={name:"SOItemEdit",mixins:[we],created:function(){var e=this;this.$route.params.soId&&this.loadSOItem(this.$route.params.soId).then(function(){e.initSOModelParameters()})},data:function(){return{newSOItem:{number:"",soModelId:"",parameters:{}},soModelParameters:[],soModel:{}}},watch:{"newSOItem.soModelId":function(e){e&&(this.soModel=this.soModels.filter(function(t){return t.id===e})[0])}},computed:{soModels:function(){return this.$store.getters.soModels},soModelMeasurable:function(){var e=this.soModel.measurable||[],t=[];return e.forEach(function(e){t.push({name:e})}),t}},methods:{resetSOModels:function(){this.soModelParameters=[{key:"C9",value:0},{key:"C8",value:0},{key:"C7",value:0},{key:"C6",value:0},{key:"C5",value:0},{key:"C4",value:0},{key:"C3",value:0},{key:"C2",value:0},{key:"C1",value:0},{key:"C0",value:0},{key:"length ( m )",value:0}],this.newSOItem.parameters={C9:0,C8:0,C7:0,C6:0,C5:0,C4:0,C3:0,C2:0,C1:0,C0:0,length:0}},loadSOItem:function(e){var t=this;return this.$store.dispatch("getSOItem",e).then(function(e){var n=e.data.data;t.newSOItem={number:n.number,parameters:n.parameters,soModelId:n.soModel.id}})},initSOModelParameters:function(){var e=this.newSOItem.parameters;for(var t in this.newSOItem.parameters=e,e)this.soModelParameters.push({key:t,value:e[t]})},editSO:function(e,t){this.newSOItem.parameters[e]=t},cancel:function(){this.toPath("SOItemList")},submit:function(){var e=this;this.$store.dispatch("updateSOItem",{soId:this.$route.params.soId,payload:this.newSOItem}).then(function(){e.$message({message:"成功編輯 ".concat(e.newSOItem.number),type:"success",center:!0,duration:1800}),e.toPath("SOItemList")}).catch(function(t){e.$message.error("請重新檢查 ".concat(t.response.data.result))})}}},fs=hs,gs=Object(Ie["a"])(fs,ms,ps,!1,null,null,null),bs=gs.exports,vs=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"measuresSo"},[n("h1",[e._v("傾度管量測")]),n("el-form",{attrs:{"label-position":"top"}},[n("section",[n("h2",[e._v("基本資料")]),n("p",[e._v("案號： "+e._s(e.projectNumber))]),n("p",[e._v("名稱： "+e._s(e.projectName))])]),n("section",[n("h2",[e._v("量測作業")]),n("el-form-item",{attrs:{label:"專案階段",required:""}},[n("el-select",{attrs:{placeholder:"第 1 次開挖"},on:{change:e.clearMeasuresDatas},model:{value:e.projectPhaseId,callback:function(t){e.projectPhaseId=t},expression:"projectPhaseId"}},e._l(e.projectPhases,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),n("el-form-item",{attrs:{label:"量測點編號",required:""}},[n("el-select",{attrs:{placeholder:"SO-01"},on:{change:e.onChangeLocation},model:{value:e.soLocationNumber,callback:function(t){e.soLocationNumber=t},expression:"soLocationNumber"}},e._l(e.project.soLocation,function(e){return n("el-option",{key:e.number,attrs:{label:e.number,value:e.number}})}))],1),n("el-form-item",{attrs:{label:"傾度管連線 IP",required:""}},[n("el-input",{attrs:{placeholder:"192.168.58.200"},on:{change:e.clearMeasuresDatas},model:{value:e.wiseIP,callback:function(t){e.wiseIP=t},expression:"wiseIP"}})],1),n("span",[e._v("應量測深度 "+e._s(e.currentDepth)+" 公尺")]),n("el-form-item",{attrs:{label:" 請由下往上量，間隔 1m 量測一次","label-width":"300px"}}),n("el-button",{attrs:{disabled:e.measuresSoDatas.length===e.currentDepth||!e.projectPhaseId||e.isMeasuring},on:{click:e.measures}},[e.isMeasuring?n("span",[e._v("量測中")]):n("span",[e._v("量測")])])],1),e.measuresSoDatas.length?n("section",[n("p",[e._v("\n        應量測 "+e._s(e.currentDepth)+" 筆，已量測"+e._s(e.measuresSoDatas.length)+"筆\n      ")]),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.measuresSoDatas}},[n("el-table-column",{attrs:{fixed:"",type:"index",width:"50"}}),n("el-table-column",{attrs:{prop:"date",label:"日期",width:"100"}}),n("el-table-column",{attrs:{prop:"time",label:"時間",width:"100"}}),n("el-table-column",{attrs:{prop:"depth",label:"深度(m)",width:"80"}}),n("el-table-column",{attrs:{prop:"temp",label:"溫度(c)",width:"150"}}),n("el-table-column",{attrs:{prop:"VoltageX",label:"原始電壓",width:"120"}}),n("el-table-column",{attrs:{prop:"degreeX",label:"傾斜角度(度C)",width:"150"}}),n("el-table-column",{attrs:{prop:"displacement",label:"位移量(cm)",width:"150"}}),n("el-table-column",{attrs:{prop:"totalDisplacement",label:"總位移量(cm)",width:"150"}})],1),n("el-button",{on:{click:e.clearMeasuresDatas}},[e._v("清除資料")]),n("el-button",{attrs:{disabled:e.measuresSoDatas.length<e.currentDepth||e.isSend},on:{click:e.uploadMeasuresDatas}},[e.isSend?n("span",[e._v("已上傳")]):n("span",[e._v("確認無誤並上傳")])])],1):e._e()])],1)},ws=[],js={wiseIP:""},ys=0,Ps=1,Ss=0,_s=1,Is=3.1415926,ks=function(e,t,n,s){var a,o,r,i;return js.wiseIP="http://"+e,Cs(ys,_s,Ps,_s).then(function(){return xs(ys,Ss)}).then(function(){return xs(Ps,Ss)}).then(function(){return Os()}).then(function(e){a=e.data}).then(function(){return xs(Ps,_s)}).then(function(){return xs(Ps,Ss)}).then(function(){return Os()}).then(function(e){o=e.data}).then(function(){return xs(Ps,_s)}).then(function(){return xs(Ps,Ss)}).then(function(){return Os()}).then(function(e){r=e.data}).then(function(){Cs(ys,_s,Ps,_s)}).then(function(){i=$s(o.Eg,a.Eg,r.Eg,n,s,t),t.unshift(i)})};function Cs(e,t,n,s){return Ms("PATCH","/do_value/slot_0",{DOVal:[{Ch:e,Val:t},{Ch:n,Val:s}]})}function xs(e,t){return Ls(),Ms("PATCH","/do_value/slot_0",{DOVal:[{Ch:e,Val:t}]})}function Os(){return Ls(),Ms("GET","/ai_value/slot_0/ch_0","")}function Ms(e,t,n){return Rt()({method:e,url:js.wiseIP+t,data:JSON.stringify(n),headers:{Accept:"application/json",Authorization:"Basic cm9vdDowMDAw"}})}function Ls(){var e=(new Date).getTime();do{}while((new Date).getTime()-e<500)}function $s(e,t,n,s,a,o){var r,i,c,l,u,d,m,p,h,f,g;return r=e/1e6,i=t/1e6,c=n/1e6,u=Ds(r),l=Gs(i,u,s),d=Gs(c,u,s),m=Es(l),p=Es(d),h=Vs(m,100),Vs(p,100),f=o.length?o[0].totalDisplacement+h:h,g=-a+o.length,{date:Us(),time:Rs(),temp:u,VoltageX:i,degreeX:m,displacement:h,totalDisplacement:f,depth:g}}function Ds(e){var t=nn.getters.getTempFormulaParameter,n=t.reduce(function(t,n,s){return s%2===0?t-n*Math.pow(e,s):t+n*Math.pow(e,s)},0);return n}function Gs(e,t,n){var s=0,a=n.soModel.id;if("something"===a){var o=n.parameters,r=[o.c0*t*e,o.c1*t*t,o.c2*t,1*o.c3,o.c4*e,o.c5*e*e];s=r.reduce(function(e,t){return e+t},0)}return s}function Es(e){return e/1e3/Is*180}function Vs(e,t){return Math.sin(e*Is/180)*t}function Us(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1>10?e.getMonth()+1:"0".concat(e.getMonth()+1),s=e.getDate()>10?e.getDate():"0".concat(e.getDate());return"".concat(t,"/").concat(n,"/").concat(s)}function Rs(){var e=new Date,t=e.getHours(),n=e.getMinutes()>10?e.getMinutes():"0".concat(e.getMinutes()),s=e.getSeconds()>10?e.getSeconds():"0".concat(e.getSeconds());return"".concat(t,":").concat(n,":").concat(s)}var Ts={data:function(){return{wiseIP:"192.168.58.200",measuresSoDatas:[],projectPhaseId:"",soLocationNumber:"",soItem:{},isSend:!1,isMeasuring:!1,currentSoLocationIndex:-1}},methods:{measures:function(){var e=this,t=new Promise(function(e){setTimeout(function(){e("Promise A win!")},5e3)}),n=ks(this.wiseIP,this.measuresSoDatas,this.soItem,this.currentDepth);Promise.race([t,n]).then(function(){e.isMeasuring=!1}).catch(function(){e.isMeasuring=!1}),this.isMeasuring=!0},clearMeasuresDatas:function(){this.measuresSoDatas=[],this.isSend=!1},uploadMeasuresDatas:function(){var e={projectId:this.$route.params.projectId,projectPhaseId:this.projectPhaseId,soLocationNumber:this.soLocationNumber,soItemId:this.soItem.id,soItemParameters:this.soItem.parameters,measureResult:this.measuresSoDatas};this.$store.dispatch("uploadMeasuresDatas",e),this.isSend=!0},getSOItem:function(){var e=this;this.me.soItem&&this.$store.dispatch("getSOItem",this.me.soItem.id).then(function(t){e.soItem=t.data.data})},onChangeLocation:function(){var e,t=this;e=this.project.soLocation.filter(function(e){return e.number===t.soLocationNumber}),this.currentSoLocationIndex=this.project.soLocation.indexOf(e.shift()),this.clearMeasuresDatas()}},computed:{project:function(){return this.$store.getters.currentProject},projectNumber:function(){return this.project.number},projectName:function(){return this.project.name},projectPhases:function(){return this.$store.getters.projectPhases},me:function(){return this.$store.getters.me},currentDepth:function(){return~this.currentSoLocationIndex?this.project.soLocation[this.currentSoLocationIndex].depth:0}},mounted:function(){this.getSOItem()},beforeDestroy:function(){"https:"===window.location.protocol&&(window.location.protocol="https:")}},As=Ts,Ns=Object(Ie["a"])(As,vs,ws,!1,null,null,null),qs=Ns.exports;pe["default"].use($e["a"]);var zs=new $e["a"]({mode:"history",base:"/",routes:[{path:"/",name:"Entry",component:Re},{path:"/user-info",name:"UserInfo",component:Fe,meta:{requireAuth:!0},beforeEnter:function(e,t,n){nn.dispatch("getMe").then(function(){n()})}},{path:"/companies",name:"CompanyList",component:ht,meta:{requireAuth:!0},beforeEnter:function(e,t,n){nn.dispatch("getCompanies").then(function(){n()})}},{path:"/users",name:"UserList",component:Xe,meta:{requireAuth:!0},beforeEnter:function(e,t,n){Promise.all([nn.commit("setUser",{}),nn.dispatch("getUsers")]).then(function(){n()})}},{path:"/user-create",name:"UserCreate",component:nt,meta:{requireAuth:!0},beforeEnter:function(e,t,n){Promise.all([nn.dispatch("getRoles"),nn.dispatch("getCompanies"),nn.dispatch("getSOItems"),nn.dispatch("getRolesPermissions")]).then(function(){n()})}},{path:"/user/:userId",name:"UserEdit",component:ct,meta:{requireAuth:!0},beforeEnter:function(e,t,n){Promise.all([nn.dispatch("getRoles"),nn.dispatch("getCompanies"),nn.dispatch("getSOItems"),nn.dispatch("getRolesPermissions")]).then(function(){return"/companies"!==t.path?nn.dispatch("getUser",e.params.userId):Promise.resolve()}).then(function(){n()})}},{path:"/permisson-setup",name:"PermissionSetup",component:jt,meta:{requireAuth:!0},beforeEnter:function(e,t,n){Promise.all([nn.dispatch("getPermissions"),nn.dispatch("getRolesPermissions")]).then(function(){n()})}},{path:"/projects",name:"ProjectList",component:$t,meta:{requireAuth:!0},beforeEnter:function(e,t,n){nn.dispatch("getProjects").then(function(){n()})}},{path:"/project-setting",name:"ProjectSetting",component:kt,meta:{requireAuth:!0},beforeEnter:function(e,t,n){nn.dispatch("getProjects").then(function(){n()})}},{path:"/project-create",name:"ProjectCreate",component:cn,meta:{requireAuth:!0},beforeEnter:function(e,t,n){Promise.all([nn.dispatch("getCompanies"),nn.dispatch("getMe"),nn.dispatch("getUsers"),nn.dispatch("getVGs"),nn.dispatch("getSteels")]).then(function(){n()})}},{path:"/project/:projectId",name:"ProjectEdit",component:hn,meta:{requireAuth:!0},beforeEnter:function(e,t,n){Promise.all([nn.dispatch("getMe"),nn.dispatch("getCompanies"),nn.dispatch("getUsers"),nn.dispatch("getVGs"),nn.dispatch("getSteels")]).then(function(){return"/steels"!==t.path?nn.dispatch("getProject",e.params.projectId):Promise.resolve()}).then(function(){n()})}},{path:"/project-monitor/:projectId",name:"ProjectMonitor",component:En,meta:{requireAuth:!0},beforeEnter:function(e,t,n){Promise.all([nn.dispatch("getProject",e.params.projectId)]).then(function(){n()})}},{path:"/measures/so/:projectId",name:"MeasuresSo",component:qs,meta:{requireAuth:!0},beforeEnter:function(e,t,n){Promise.all([nn.dispatch("getProject",e.params.projectId),nn.dispatch("getMe"),nn.dispatch("getProjectPhases")]).then(function(){n()})}},{path:"/project-phases",name:"ProjectPhaseList",component:Nn,meta:{requireAuth:!0},beforeEnter:function(e,t,n){Promise.all([nn.dispatch("getProjectPhases")]).then(function(){n()})}},{path:"/vgs",name:"VGList",component:Qn,meta:{requireAuth:!0},beforeEnter:function(e,t,n){Promise.all([nn.dispatch("getVGs")]).then(function(){n()})}},{path:"/steels",name:"SteelList",component:Kn,meta:{requireAuth:!0},beforeEnter:function(e,t,n){Promise.all([nn.dispatch("getSteels")]).then(function(){n()})}},{path:"/so-items",name:"SOItemList",component:os,meta:{requireAuth:!0},beforeEnter:function(e,t,n){nn.dispatch("getSOItems").then(function(){n()})}},{path:"/soItem-create",name:"SOItemCreate",component:ds,meta:{requireAuth:!0},beforeEnter:function(e,t,n){Promise.all([nn.dispatch("getSOItems"),nn.dispatch("getSOModels")]).then(function(){n()})}},{path:"/soItem/:soId",name:"SOItemEdit",component:bs,meta:{requireAuth:!0},beforeEnter:function(e,t,n){Promise.all([nn.dispatch("getSOModels")]).then(function(){n()})}}]});zs.beforeEach(function(e,t,n){nn.getters.isLogined||qt.reloadLogin(),nn.getters.isLogined&&"/"===e.path?n({name:"ProjectList"}):!nn.getters.isLogined&&e.meta.requireAuth&&n({name:"Entry"}),n()});var Fs=zs,Bs=n("c87b"),Js=n.n(Bs),Qs=n("4897"),Hs=n.n(Qs);Hs.a.use(Js.a),pe["default"].use(ae.a);n("1ca9");var Ys=n("ecee"),Xs=n("c074"),Ws=n("9ca8");n("ef97"),n("d28f"),n("627c"),n("007d"),n("95a8"),n("0352");pe["default"].use(me.a),pe["default"].use(ue.a),pe["default"].use(ce.a),pe["default"].use(re.a),pe["default"].use(ae.a),pe["default"].use(ne.a),pe["default"].use(ee.a),pe["default"].use(Z.a),pe["default"].use(X.a),pe["default"].use(H.a),pe["default"].use(J.a),pe["default"].use(F.a),pe["default"].use(q.a),pe["default"].use(A.a),pe["default"].use(R.a),pe["default"].use(V.a),pe["default"].use(G.a),pe["default"].use($.a),pe["default"].use(M.a),pe["default"].use(x.a),pe["default"].use(k.a),pe["default"].use(_.a),pe["default"].use(P.a),pe["default"].use(j.a),pe["default"].use(v.a),pe["default"].use(g.a),pe["default"].use(h.a),pe["default"].use(m.a),pe["default"].use(u.a),pe["default"].use(c.a),pe["default"].use(r.a),pe["default"].component("chart",Ws["a"]),pe["default"].prototype.$message=a.a,pe["default"].prototype.moment=jn.a,Ys["c"].add(Xs["a"]),pe["default"].config.productionTip=!1,new pe["default"]({router:Fs,store:nn,render:function(e){return e(Le)}}).$mount("#app")},"5dfc":function(e,t,n){"use strict";var s=n("30d6"),a=n.n(s);a.a},"64a9":function(e,t,n){},6691:function(e,t,n){},"6b31":function(e,t,n){},"763d":function(e,t,n){},"7f22":function(e,t,n){},aa29:function(e,t,n){},c322:function(e,t,n){"use strict";var s=n("d073"),a=n.n(s);a.a},d073:function(e,t,n){},eeb3:function(e,t,n){"use strict";var s=n("36c0"),a=n.n(s);a.a}});
//# sourceMappingURL=app.66f8368a.js.map